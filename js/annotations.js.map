{"version":3,"file":"annotations.js","sources":["../node_modules/wicked-elements/esm/3rd/regular-elements/poorly/event.js","../node_modules/wicked-elements/esm/3rd/regular-elements/poorly/weakset.js","../node_modules/wicked-elements/esm/3rd/regular-elements/poorly/assign.js","../node_modules/wicked-elements/esm/3rd/regular-elements/poly/contains.js","../node_modules/wicked-elements/esm/3rd/regular-elements/poly/matches.js","../node_modules/wicked-elements/esm/3rd/regular-elements/index.js","../node_modules/wicked-elements/esm/3rd/regular-elements/3rd/disconnected.js","../node_modules/wicked-elements/esm/3rd/regular-elements/3rd/attributechanged.js","../node_modules/wicked-elements/esm/index.js","../node_modules/ancestors/index.js","../node_modules/index-of/index.js","../node_modules/dom-seek/lib/index.js","../node_modules/dom-seek/index.js","../components/annotations/highlight.js","../components/annotations/marker.js","../components/annotations/sidebar.js","../node_modules/@ungap/weakmap/esm/index.js","../node_modules/@ungap/template-literal/esm/index.js","../node_modules/@ungap/template-tag-arguments/esm/index.js","../node_modules/hyperhtml-wire/esm/index.js","../node_modules/lighterhtml/esm/shared.js","../node_modules/@ungap/create-content/esm/index.js","../node_modules/@ungap/essential-map/esm/index.js","../node_modules/lighterhtml/node_modules/domdiff/esm/utils.js","../node_modules/lighterhtml/node_modules/domdiff/esm/index.js","../node_modules/@ungap/import-node/esm/index.js","../node_modules/domtagger/esm/constants.js","../node_modules/@ungap/trim/esm/index.js","../node_modules/domtagger/esm/sanitizer.js","../node_modules/domtagger/esm/walker.js","../node_modules/domtagger/esm/index.js","../node_modules/hyperhtml-style/esm/index.js","../node_modules/lighterhtml/esm/tagger.js","../node_modules/lighterhtml/esm/index.js","../components/annotations/marker-menu.js","../components/annotations/xpaths.js","../components/annotations/notes.js"],"sourcesContent":["/**\n * ISC License\n *\n * Copyright (c) 2018, Andrea Giammarchi, @WebReflection\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n * PERFORMANCE OF THIS SOFTWARE.\n */\n\nvar $Event;\n\ntry {\n  new Event('!');\n  $Event = Event;\n} catch(o_O) {\n  try {\n    new CustomEvent('!');\n    $Event = CustomEvent;\n  } catch(o_O) {\n    $Event = function (type) {\n      var e = document.createEvent('Event');\n      e.initEvent(type, false, false);\n      return e;\n    };\n  }\n}\n\nexport default $Event;\n","/**\n * ISC License\n *\n * Copyright (c) 2018, Andrea Giammarchi, @WebReflection\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n * PERFORMANCE OF THIS SOFTWARE.\n */\n\nvar $WeakSet;\n\ntry {\n  $WeakSet = (new WeakSet).constructor;\n} catch(o_O) {\n  try {\n    // IE11 apparently has WeakMap but no WeakSet\n    o_O = ($WeakSet = new WeakMap && function () {\n      this.$ = new WeakMap;\n    }).prototype;\n    o_O.add = function (O) {\n      this.$.set(O, 0);\n      return this;\n    };\n    o_O.has = function (O) {\n      return this.$.has(O);\n    };\n    o_O.delete = function (O) {\n      return this.$.delete(O);\n    };\n  } catch(o_O) {\n    // all other browsers\n    var i = 0;\n    o_O = ($WeakSet = function () {\n      this.$ = ['__', Math.random(), i++, '__'].join('ws');\n    }).prototype;\n    o_O.add = function (O) {\n      if (!this.has(O))\n        Object.defineProperty(O, this.$, {value:true, configurable:true});\n      return this;\n    };\n    o_O.has = function (O) {\n      return this.hasOwnProperty.call(O, this.$);\n    };\n    o_O.delete = function (O) {\n      return delete O[this.$];\n    };\n  }\n}\n\nexport default $WeakSet;\n","/**\n * ISC License\n *\n * Copyright (c) 2018, Andrea Giammarchi, @WebReflection\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n * PERFORMANCE OF THIS SOFTWARE.\n */\n\nexport default Object.assign || function (target) {\n  for (var o, i = 1; i < arguments.length; i++) {\n    o = arguments[i] || {};\n    for (var k in o) {\n      if (o.hasOwnProperty(k))\n        target[k] = o[k];\n    }\n  }\n  return target;\n};\n","// borrowed from https://github.com/WebReflection/dom4/blob/master/src/dom4.js#L361\nvar contains = document.contains || function (el) {\n  while (el && el !== this) el = el.parentNode;\n  return this === el;\n};\n\nexport default contains;\n","var indexOf = [].indexOf;\n\n// borrowed from https://github.com/WebReflection/dom4/blob/master/src/dom4.js#L130\nvar matches = 'matches' in document.documentElement ?\n  function (el, selector) {\n    return el.matches(selector);\n  } :\n  function (el, selector) {\n    return (\n      el.matchesSelector ||\n      el.webkitMatchesSelector ||\n      el.khtmlMatchesSelector ||\n      el.mozMatchesSelector ||\n      el.msMatchesSelector ||\n      el.oMatchesSelector ||\n      fallback\n    ).call(el, selector);\n  };\n\nexport default matches;\n\nfunction fallback(selector) {\n  var parentNode = this.parentNode;\n  return !!parentNode && -1 < indexOf.call(\n    parentNode.querySelectorAll(selector),\n    this\n  );\n}\n","/**\n * ISC License\n *\n * Copyright (c) 2018, Andrea Giammarchi, @WebReflection\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n * PERFORMANCE OF THIS SOFTWARE.\n */\n\nimport Event from './poorly/event.js';\nimport WeakSet from './poorly/weakset.js';\nimport assign from './poorly/assign.js';\n\nimport contains from './poly/contains.js';\nimport matches from './poly/matches.js';\n\nimport attributechanged from './3rd/attributechanged.js';\nimport disconnected from './3rd/disconnected.js';\n\nvar bootstrap = true;\n\nvar query = [];\nvar config = [];\nvar waiting = {};\nvar known = {};\n\nvar regularElements = {\n  Event: Event,\n  WeakSet: WeakSet,\n  assign: assign,\n  document: document,\n  define: function (selector, options) {\n    if (bootstrap) {\n      bootstrap = false;\n      init(regularElements.document);\n    }\n    var type = typeof selector;\n    if (type === 'string') {\n      if (-1 < query.indexOf(selector))\n        throw new Error('duplicated: ' + selector);\n      query.push(selector);\n      config.push(options || {});\n      ready();\n      if (selector in waiting) {\n        waiting[selector](config[config.length - 1]);\n        delete waiting[selector];\n      }\n    } else {\n      if (type !== \"object\" || selector.nodeType !== 1)\n        throw new Error('undefinable: ' + selector);\n      setupListeners(selector, options || {});\n    }\n  },\n  get: function (selector) {\n    var i = query.indexOf(selector);\n    return i < 0 ? null : assign({}, config[i]);\n  },\n  whenDefined: function (selector) {\n    return Promise.resolve(\n      regularElements.get(selector) ||\n      new Promise(function ($) {\n        waiting[selector] = $;\n      })\n    );\n  }\n};\n\n// passing along regularElements as poly for Event and WeakSet\nvar lifecycle = disconnected(regularElements);\nvar observe = {\n  attributechanged: attributechanged(regularElements),\n  connected: lifecycle,\n  disconnected: lifecycle\n};\n\nexport default regularElements;\nexport {regularElements, assign, Event, WeakSet};\n\nfunction changes(records) {\n  for (var i = 0, length = records.length; i < length; i++)\n    setupList(records[i].addedNodes, false);\n}\n\nfunction init(doc) {\n  try {\n    (new MutationObserver(changes))\n      .observe(doc, {subtree: true, childList: true});\n  }\n  catch(o_O) {\n    doc.addEventListener(\n      'DOMNodeInserted',\n      function (e) {\n        changes([{addedNodes: [e.target]}]);\n      },\n      false\n    );\n  }\n  if (doc.readyState !== 'complete')\n    doc.addEventListener('DOMContentLoaded', ready, {once: true});\n}\n\nfunction ready() {\n  if (query.length)\n    setupList(regularElements.document.querySelectorAll(query), true);\n}\n\nfunction setup(node) {\n  setupList(node.querySelectorAll(query), true);\n  for (var ws, css, i = 0, length = query.length; i < length; i++) {\n    css = query[i];\n    ws = known[css] || (known[css] = new WeakSet);\n    if (!ws.has(node) && matches(node, query[i])) {\n      ws.add(node);\n      setupListeners(node, config[i]);\n    }\n  }\n}\n\nfunction setupList(nodes, isElement) {\n  for (var node, i = 0, length = nodes.length; i < length; i++) {\n    node = nodes[i];\n    if (isElement || node.nodeType === 1)\n      setup(node);\n  }\n}\n\nfunction setupListener(node, options, type, dispatch) {\n  var method = options['on' + type];\n  if (method) {\n    observe[type](node, options.attributeFilter)\n      .addEventListener(type, method, false);\n    if (dispatch && contains.call(regularElements.document, node))\n      node.dispatchEvent(new Event(type));\n  }\n}\n\nfunction setupListeners(node, options) {\n  setupListener(node, options, 'attributechanged', false);\n  setupListener(node, options, 'disconnected', false);\n  setupListener(node, options, 'connected', true);\n}\n","/*! (c) Andrea Giammarchi */\nfunction disconnected(poly) {'use strict';\n  var CONNECTED = 'connected';\n  var DISCONNECTED = 'dis' + CONNECTED;\n  var Event = poly.Event;\n  var WeakSet = poly.WeakSet;\n  var notObserving = true;\n  var observer = new WeakSet;\n  return function observe(node) {\n    if (notObserving) {\n      notObserving = !notObserving;\n      startObserving(node.ownerDocument);\n    }\n    observer.add(node);\n    return node;\n  };\n  function startObserving(document) {\n    var dispatched = null;\n    try {\n      (new MutationObserver(changes)).observe(\n        document,\n        {subtree: true, childList: true}\n      );\n    }\n    catch(o_O) {\n      var timer = 0;\n      var records = [];\n      var reschedule = function (record) {\n        records.push(record);\n        clearTimeout(timer);\n        timer = setTimeout(\n          function () {\n            changes(records.splice(timer = 0, records.length));\n          },\n          0\n        );\n      };\n      document.addEventListener(\n        'DOMNodeRemoved',\n        function (event) {\n          reschedule({addedNodes: [], removedNodes: [event.target]});\n        },\n        true\n      );\n      document.addEventListener(\n        'DOMNodeInserted',\n        function (event) {\n          reschedule({addedNodes: [event.target], removedNodes: []});\n        },\n        true\n      );\n    }\n    function changes(records) {\n      dispatched = new Tracker;\n      for (var\n        record,\n        length = records.length,\n        i = 0; i < length; i++\n      ) {\n        record = records[i];\n        dispatchAll(record.removedNodes, DISCONNECTED, CONNECTED);\n        dispatchAll(record.addedNodes, CONNECTED, DISCONNECTED);\n      }\n      dispatched = null;\n    }\n    function dispatchAll(nodes, type, counter) {\n      for (var\n        node,\n        event = new Event(type),\n        length = nodes.length,\n        i = 0; i < length;\n        (node = nodes[i++]).nodeType === 1 &&\n        dispatchTarget(node, event, type, counter)\n      );\n    }\n    function dispatchTarget(node, event, type, counter) {\n      if (observer.has(node) && !dispatched[type].has(node)) {\n        dispatched[counter].delete(node);\n        dispatched[type].add(node);\n        node.dispatchEvent(event);\n        /*\n        // The event is not bubbling (perf reason: should it?),\n        // hence there's no way to know if\n        // stop/Immediate/Propagation() was called.\n        // Should DOM Level 0 work at all?\n        // I say it's a YAGNI case for the time being,\n        // and easy to implement in user-land.\n        if (!event.cancelBubble) {\n          var fn = node['on' + type];\n          if (fn)\n            fn.call(node, event);\n        }\n        */\n      }\n      for (var\n        children = node.children,\n        length = children.length,\n        i = 0; i < length;\n        dispatchTarget(children[i++], event, type, counter)\n      );\n    }\n    function Tracker() {\n      this[CONNECTED] = new WeakSet;\n      this[DISCONNECTED] = new WeakSet;\n    }\n  }\n}\nexport default disconnected;\n","/*! (c) Andrea Giammarchi */\nfunction attributechanged(poly) {'use strict';\n  var Event = poly.Event;\n  return function observe(node, attributeFilter) {\n    var options = {attributes: true, attributeOldValue: true};\n    var filtered = attributeFilter instanceof Array && attributeFilter.length;\n    if (filtered)\n      options.attributeFilter = attributeFilter.slice(0);\n    try {\n      (new MutationObserver(changes)).observe(node, options);\n    } catch(o_O) {\n      options.handleEvent = filtered ? handleEvent : attrModified;\n      node.addEventListener('DOMAttrModified', options, true);\n    }\n    return node;\n  };\n  function attrModified(event) {\n    dispatchEvent(event.target, event.attrName, event.prevValue);\n  }\n  function dispatchEvent(node, attributeName, oldValue) {\n    var event = new Event('attributechanged');\n    event.attributeName = attributeName;\n    event.oldValue = oldValue;\n    event.newValue = node.getAttribute(attributeName);\n    node.dispatchEvent(event);\n  }\n  function changes(records) {\n    for (var record, i = 0, length = records.length; i < length; i++) {\n      record = records[i];\n      dispatchEvent(record.target, record.attributeName, record.oldValue);\n    }\n  }\n  function handleEvent(event) {\n    if (-1 < this.attributeFilter.indexOf(event.attrName))\n      attrModified(event);\n  }\n}\nexport default attributechanged;\n","/**\n * ISC License\n *\n * Copyright (c) 2018, Andrea Giammarchi, @WebReflection\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n * PERFORMANCE OF THIS SOFTWARE.\n */\n\nimport regularElements, {WeakSet} from './3rd/regular-elements/index.js';\n\n// minifier friendly constants\nvar ATTRIBUTE_FILTER = 'attributeFilter';\nvar ONDISCONNECTED = 'ondisconnected';\nvar ONATTRIBUTECHANGED = 'onattributechanged';\n\n// one off scoped shortcut\nvar create = Object.create;\n\n// get() and whenDefined() are just the same\n// NOTE: the component is not returned,\n//       only its initial definition.\n//       This works well in terms of security\n//       so that a component prototype won't be\n//       exposed directly through the API.\nvar wickedElements = create(regularElements, {\n  define: {\n    value: function (selector, component) {\n      var ws = new WeakSet;\n      var definition = {onconnected: setup};\n      if (ONDISCONNECTED in component)\n        definition[ONDISCONNECTED] = setup;\n      if (ONATTRIBUTECHANGED in component) {\n        definition[ONATTRIBUTECHANGED] = setup;\n        definition[ATTRIBUTE_FILTER] = component[ATTRIBUTE_FILTER] || [];\n      }\n      addIfNeeded(component, 'init', init);\n      addIfNeeded(component, 'handleEvent', handleEvent);\n      regularElements.define(selector, definition);\n      function setup(event) {\n        var el = event.currentTarget;\n        var type = event.type;\n        el.removeEventListener(type, setup);\n        if (!ws.has(el)) {\n          ws.add(el);\n          bootstrap(component, event, el, 'on' + type);\n        }\n      }\n    }\n  }\n});\n\nexport default wickedElements;\n\nfunction addIfNeeded(component, key, value) {\n  if (!(key in component))\n    component[key] = value;\n}\n\nfunction bootstrap(component, event, el, method) {\n  var handler = create(component);\n  var invoke = false;\n  for (var key in component) {\n    if (key.slice(0, 2) === 'on') {\n      el.addEventListener(key.slice(2), handler, false);\n      if (key === method)\n        invoke = !invoke;\n    }\n  }\n  handler.init(event);\n  if (invoke)\n    handler.handleEvent(event);\n}\n\nfunction handleEvent(event) {\n  var type = 'on' + event.type;\n  if (type in this)\n    this[type](event);\n}\n\nfunction init(event) {\n  this.el = event.currentTarget;\n}\n","module.exports = parents\n\nfunction parents(node, filter) {\n  var out = []\n\n  filter = filter || noop\n\n  do {\n    out.push(node)\n    node = node.parentNode\n  } while(node && node.tagName && filter(node))\n\n  return out.slice(1)\n}\n\nfunction noop(n) {\n  return true\n}\n","/*!\n * index-of <https://github.com/jonschlinkert/index-of>\n *\n * Copyright (c) 2014-2015 Jon Schlinkert.\n * Licensed under the MIT license.\n */\n\n'use strict';\n\nmodule.exports = function indexOf(arr, ele, start) {\n  start = start || 0;\n  var idx = -1;\n\n  if (arr == null) return idx;\n  var len = arr.length;\n  var i = start < 0\n    ? (len + start)\n    : start;\n\n  if (i >= arr.length) {\n    return -1;\n  }\n\n  while (i < len) {\n    if (arr[i] === ele) {\n      return i;\n    }\n    i++;\n  }\n\n  return -1;\n};\n","'use strict';\n\nexports.__esModule = true;\nexports['default'] = seek;\n\nvar _ancestors = require('ancestors');\n\nvar _ancestors2 = _interopRequireDefault(_ancestors);\n\nvar _indexOf = require('index-of');\n\nvar _indexOf2 = _interopRequireDefault(_indexOf);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar E_SHOW = 'Argument 1 of seek must use filter NodeFilter.SHOW_TEXT.';\nvar E_WHERE = 'Argument 2 of seek must be a number or a Text Node.';\n\nvar SHOW_TEXT = 4;\nvar TEXT_NODE = 3;\n\nfunction seek(iter, where) {\n  if (iter.whatToShow !== SHOW_TEXT) {\n    throw new Error(E_SHOW);\n  }\n\n  var count = 0;\n  var node = iter.referenceNode;\n  var predicates = null;\n\n  if (isNumber(where)) {\n    predicates = {\n      forward: function forward() {\n        return count < where;\n      },\n      backward: function backward() {\n        return count > where;\n      }\n    };\n  } else if (isText(where)) {\n    var forward = before(node, where) ? function () {\n      return false;\n    } : function () {\n      return node !== where;\n    };\n    var backward = function backward() {\n      return node != where || !iter.pointerBeforeReferenceNode;\n    };\n    predicates = { forward: forward, backward: backward };\n  } else {\n    throw new Error(E_WHERE);\n  }\n\n  while (predicates.forward() && (node = iter.nextNode()) !== null) {\n    count += node.nodeValue.length;\n  }\n\n  while (predicates.backward() && (node = iter.previousNode()) !== null) {\n    count -= node.nodeValue.length;\n  }\n\n  return count;\n}\n\nfunction isNumber(n) {\n  return !isNaN(parseInt(n)) && isFinite(n);\n}\n\nfunction isText(node) {\n  return node.nodeType === TEXT_NODE;\n}\n\nfunction before(ref, node) {\n  if (ref === node) return false;\n\n  var common = null;\n  var left = [ref].concat((0, _ancestors2['default'])(ref)).reverse();\n  var right = [node].concat((0, _ancestors2['default'])(node)).reverse();\n\n  while (left[0] === right[0]) {\n    common = left.shift();\n    right.shift();\n  }\n\n  left = left[0];\n  right = right[0];\n\n  var l = (0, _indexOf2['default'])(common.childNodes, left);\n  var r = (0, _indexOf2['default'])(common.childNodes, right);\n\n  return l > r;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJzZWVrIiwiRV9TSE9XIiwiRV9XSEVSRSIsIlNIT1dfVEVYVCIsIlRFWFRfTk9ERSIsIml0ZXIiLCJ3aGVyZSIsIndoYXRUb1Nob3ciLCJFcnJvciIsImNvdW50Iiwibm9kZSIsInJlZmVyZW5jZU5vZGUiLCJwcmVkaWNhdGVzIiwiaXNOdW1iZXIiLCJmb3J3YXJkIiwiYmFja3dhcmQiLCJpc1RleHQiLCJiZWZvcmUiLCJwb2ludGVyQmVmb3JlUmVmZXJlbmNlTm9kZSIsIm5leHROb2RlIiwibm9kZVZhbHVlIiwibGVuZ3RoIiwicHJldmlvdXNOb2RlIiwibiIsImlzTmFOIiwicGFyc2VJbnQiLCJpc0Zpbml0ZSIsIm5vZGVUeXBlIiwicmVmIiwiY29tbW9uIiwibGVmdCIsImNvbmNhdCIsInJldmVyc2UiLCJyaWdodCIsInNoaWZ0IiwibCIsImNoaWxkTm9kZXMiLCJyIl0sIm1hcHBpbmdzIjoiOzs7cUJBVXdCQSxJOztBQVZ4Qjs7OztBQUNBOzs7Ozs7QUFFQSxJQUFNQyxTQUFTLDBEQUFmO0FBQ0EsSUFBTUMsVUFBVSxxREFBaEI7O0FBRUEsSUFBTUMsWUFBWSxDQUFsQjtBQUNBLElBQU1DLFlBQVksQ0FBbEI7O0FBR2UsU0FBU0osSUFBVCxDQUFjSyxJQUFkLEVBQW9CQyxLQUFwQixFQUEyQjtBQUN4QyxNQUFJRCxLQUFLRSxVQUFMLEtBQW9CSixTQUF4QixFQUFtQztBQUNqQyxVQUFNLElBQUlLLEtBQUosQ0FBVVAsTUFBVixDQUFOO0FBQ0Q7O0FBRUQsTUFBSVEsUUFBUSxDQUFaO0FBQ0EsTUFBSUMsT0FBT0wsS0FBS00sYUFBaEI7QUFDQSxNQUFJQyxhQUFhLElBQWpCOztBQUVBLE1BQUlDLFNBQVNQLEtBQVQsQ0FBSixFQUFxQjtBQUNuQk0saUJBQWE7QUFDWEUsZUFBUztBQUFBLGVBQU1MLFFBQVFILEtBQWQ7QUFBQSxPQURFO0FBRVhTLGdCQUFVO0FBQUEsZUFBTU4sUUFBUUgsS0FBZDtBQUFBO0FBRkMsS0FBYjtBQUlELEdBTEQsTUFLTyxJQUFJVSxPQUFPVixLQUFQLENBQUosRUFBbUI7QUFDeEIsUUFBSVEsVUFBVUcsT0FBT1AsSUFBUCxFQUFhSixLQUFiLElBQXNCO0FBQUEsYUFBTSxLQUFOO0FBQUEsS0FBdEIsR0FBb0M7QUFBQSxhQUFNSSxTQUFTSixLQUFmO0FBQUEsS0FBbEQ7QUFDQSxRQUFJUyxXQUFXLFNBQVhBLFFBQVc7QUFBQSxhQUFNTCxRQUFRSixLQUFSLElBQWlCLENBQUNELEtBQUthLDBCQUE3QjtBQUFBLEtBQWY7QUFDQU4saUJBQWEsRUFBQ0UsZ0JBQUQsRUFBVUMsa0JBQVYsRUFBYjtBQUNELEdBSk0sTUFJQTtBQUNMLFVBQU0sSUFBSVAsS0FBSixDQUFVTixPQUFWLENBQU47QUFDRDs7QUFFRCxTQUFPVSxXQUFXRSxPQUFYLE1BQXdCLENBQUNKLE9BQU9MLEtBQUtjLFFBQUwsRUFBUixNQUE2QixJQUE1RCxFQUFrRTtBQUNoRVYsYUFBU0MsS0FBS1UsU0FBTCxDQUFlQyxNQUF4QjtBQUNEOztBQUVELFNBQU9ULFdBQVdHLFFBQVgsTUFBeUIsQ0FBQ0wsT0FBT0wsS0FBS2lCLFlBQUwsRUFBUixNQUFpQyxJQUFqRSxFQUF1RTtBQUNyRWIsYUFBU0MsS0FBS1UsU0FBTCxDQUFlQyxNQUF4QjtBQUNEOztBQUVELFNBQU9aLEtBQVA7QUFDRDs7QUFHRCxTQUFTSSxRQUFULENBQWtCVSxDQUFsQixFQUFxQjtBQUNuQixTQUFPLENBQUNDLE1BQU1DLFNBQVNGLENBQVQsQ0FBTixDQUFELElBQXVCRyxTQUFTSCxDQUFULENBQTlCO0FBQ0Q7O0FBR0QsU0FBU1AsTUFBVCxDQUFnQk4sSUFBaEIsRUFBc0I7QUFDcEIsU0FBT0EsS0FBS2lCLFFBQUwsS0FBa0J2QixTQUF6QjtBQUNEOztBQUdELFNBQVNhLE1BQVQsQ0FBZ0JXLEdBQWhCLEVBQXFCbEIsSUFBckIsRUFBMkI7QUFDekIsTUFBSWtCLFFBQVFsQixJQUFaLEVBQWtCLE9BQU8sS0FBUDs7QUFFbEIsTUFBSW1CLFNBQVMsSUFBYjtBQUNBLE1BQUlDLE9BQU8sQ0FBQ0YsR0FBRCxFQUFNRyxNQUFOLENBQWEsNEJBQVVILEdBQVYsQ0FBYixFQUE2QkksT0FBN0IsRUFBWDtBQUNBLE1BQUlDLFFBQVEsQ0FBQ3ZCLElBQUQsRUFBT3FCLE1BQVAsQ0FBYyw0QkFBVXJCLElBQVYsQ0FBZCxFQUErQnNCLE9BQS9CLEVBQVo7O0FBRUEsU0FBT0YsS0FBSyxDQUFMLE1BQVlHLE1BQU0sQ0FBTixDQUFuQixFQUE2QjtBQUMzQkosYUFBU0MsS0FBS0ksS0FBTCxFQUFUO0FBQ0FELFVBQU1DLEtBQU47QUFDRDs7QUFFREosU0FBT0EsS0FBSyxDQUFMLENBQVA7QUFDQUcsVUFBUUEsTUFBTSxDQUFOLENBQVI7O0FBRUEsTUFBSUUsSUFBSSwwQkFBUU4sT0FBT08sVUFBZixFQUEyQk4sSUFBM0IsQ0FBUjtBQUNBLE1BQUlPLElBQUksMEJBQVFSLE9BQU9PLFVBQWYsRUFBMkJILEtBQTNCLENBQVI7O0FBRUEsU0FBT0UsSUFBSUUsQ0FBWDtBQUNEIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGFuY2VzdG9ycyBmcm9tICdhbmNlc3RvcnMnXG5pbXBvcnQgaW5kZXhPZiBmcm9tICdpbmRleC1vZidcblxuY29uc3QgRV9TSE9XID0gJ0FyZ3VtZW50IDEgb2Ygc2VlayBtdXN0IHVzZSBmaWx0ZXIgTm9kZUZpbHRlci5TSE9XX1RFWFQuJ1xuY29uc3QgRV9XSEVSRSA9ICdBcmd1bWVudCAyIG9mIHNlZWsgbXVzdCBiZSBhIG51bWJlciBvciBhIFRleHQgTm9kZS4nXG5cbmNvbnN0IFNIT1dfVEVYVCA9IDRcbmNvbnN0IFRFWFRfTk9ERSA9IDNcblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBzZWVrKGl0ZXIsIHdoZXJlKSB7XG4gIGlmIChpdGVyLndoYXRUb1Nob3cgIT09IFNIT1dfVEVYVCkge1xuICAgIHRocm93IG5ldyBFcnJvcihFX1NIT1cpXG4gIH1cblxuICBsZXQgY291bnQgPSAwXG4gIGxldCBub2RlID0gaXRlci5yZWZlcmVuY2VOb2RlXG4gIGxldCBwcmVkaWNhdGVzID0gbnVsbFxuXG4gIGlmIChpc051bWJlcih3aGVyZSkpIHtcbiAgICBwcmVkaWNhdGVzID0ge1xuICAgICAgZm9yd2FyZDogKCkgPT4gY291bnQgPCB3aGVyZSxcbiAgICAgIGJhY2t3YXJkOiAoKSA9PiBjb3VudCA+IHdoZXJlLFxuICAgIH1cbiAgfSBlbHNlIGlmIChpc1RleHQod2hlcmUpKSB7XG4gICAgbGV0IGZvcndhcmQgPSBiZWZvcmUobm9kZSwgd2hlcmUpID8gKCkgPT4gZmFsc2UgOiAoKSA9PiBub2RlICE9PSB3aGVyZVxuICAgIGxldCBiYWNrd2FyZCA9ICgpID0+IG5vZGUgIT0gd2hlcmUgfHwgIWl0ZXIucG9pbnRlckJlZm9yZVJlZmVyZW5jZU5vZGVcbiAgICBwcmVkaWNhdGVzID0ge2ZvcndhcmQsIGJhY2t3YXJkfVxuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcihFX1dIRVJFKVxuICB9XG5cbiAgd2hpbGUgKHByZWRpY2F0ZXMuZm9yd2FyZCgpICYmIChub2RlID0gaXRlci5uZXh0Tm9kZSgpKSAhPT0gbnVsbCkge1xuICAgIGNvdW50ICs9IG5vZGUubm9kZVZhbHVlLmxlbmd0aFxuICB9XG5cbiAgd2hpbGUgKHByZWRpY2F0ZXMuYmFja3dhcmQoKSAmJiAobm9kZSA9IGl0ZXIucHJldmlvdXNOb2RlKCkpICE9PSBudWxsKSB7XG4gICAgY291bnQgLT0gbm9kZS5ub2RlVmFsdWUubGVuZ3RoXG4gIH1cblxuICByZXR1cm4gY291bnRcbn1cblxuXG5mdW5jdGlvbiBpc051bWJlcihuKSB7XG4gIHJldHVybiAhaXNOYU4ocGFyc2VJbnQobikpICYmIGlzRmluaXRlKG4pXG59XG5cblxuZnVuY3Rpb24gaXNUZXh0KG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IFRFWFRfTk9ERVxufVxuXG5cbmZ1bmN0aW9uIGJlZm9yZShyZWYsIG5vZGUpIHtcbiAgaWYgKHJlZiA9PT0gbm9kZSkgcmV0dXJuIGZhbHNlXG5cbiAgbGV0IGNvbW1vbiA9IG51bGxcbiAgbGV0IGxlZnQgPSBbcmVmXS5jb25jYXQoYW5jZXN0b3JzKHJlZikpLnJldmVyc2UoKVxuICBsZXQgcmlnaHQgPSBbbm9kZV0uY29uY2F0KGFuY2VzdG9ycyhub2RlKSkucmV2ZXJzZSgpXG5cbiAgd2hpbGUgKGxlZnRbMF0gPT09IHJpZ2h0WzBdKSB7XG4gICAgY29tbW9uID0gbGVmdC5zaGlmdCgpXG4gICAgcmlnaHQuc2hpZnQoKVxuICB9XG5cbiAgbGVmdCA9IGxlZnRbMF1cbiAgcmlnaHQgPSByaWdodFswXVxuXG4gIGxldCBsID0gaW5kZXhPZihjb21tb24uY2hpbGROb2RlcywgbGVmdClcbiAgbGV0IHIgPSBpbmRleE9mKGNvbW1vbi5jaGlsZE5vZGVzLCByaWdodClcblxuICByZXR1cm4gbCA+IHJcbn1cbiJdfQ==","module.exports = require('./lib')['default'];\n","import wickedElements from 'wicked-elements'\nimport seek from 'dom-seek'\nlet rangeId = 0\n\nwickedElements.define('reader-highlight', {\n  onconnected (event) {\n    this.element = event.currentTarget\n    this.el.addEventListener('click', this)\n  },\n  onclick (event) {\n    const rangeId = this.element.dataset.rangeId\n    const selected = this.element.classList.contains('Highlight--selected')\n    if (rangeId && !selected) {\n      document\n        .querySelectorAll(`[data-range-id=\"${rangeId}\"]`)\n        .forEach(element => element.classList.add('Highlight--selected'))\n      document.body.dispatchEvent(\n        new window.CustomEvent('reader:highlight-selected', {\n          detail: { rangeId }\n        })\n      )\n    } else if (selected) {\n      document\n        .querySelectorAll(`[data-range-id=\"${rangeId}\"]`)\n        .forEach(element => element.classList.remove('Highlight--selected'))\n      document.body.dispatchEvent(\n        new window.CustomEvent('reader:highlight-deselected', {\n          detail: { rangeId }\n        })\n      )\n    }\n  }\n})\n\nwickedElements.define('[is=\"remove-highlight-button\"]', {\n  onconnected (event) {\n    this.element = event.currentTarget\n    this.element.addEventListener('click', this)\n    document.body.addEventListener('reader:highlight-selected', this)\n    document.body.addEventListener('reader:highlight-deselected', this)\n    this.element.disabled = true\n  },\n  onclick (event) {\n    document\n      .querySelectorAll(\n        `reader-highlight[data-range-id=\"${this.element.dataset.rangeId}\"]`\n      )\n      .forEach(element => {\n        const range = document.createRange()\n        range.setStartBefore(element.firstChild)\n        range.setEndAfter(element.lastChild)\n        const fragment = range.extractContents()\n        element.parentElement.replaceChild(fragment, element)\n      })\n  },\n  'onreader:highlight-selected': function (event) {\n    console.log(event)\n    this.element.disabled = false\n    this.element.dataset.rangeId = event.detail.rangeId\n  },\n  'onreader:highlight-deselected': function (event) {\n    console.log(event)\n    this.element.disabled = true\n    this.element.dataset.rangeId = null\n  }\n})\n\nwickedElements.define('[is=\"highlight-button\"]', {\n  onconnected (event) {\n    this.el = event.currentTarget\n    this.el.addEventListener('click', this)\n  },\n  onclick (event) {\n    const selection = window.getSelection()\n    if (selection.isCollapsed) return null\n    let range\n    if (selection.rangeCount > 1) {\n      const endRange = selection.getRangeAt(selection.rangeCount - 1)\n      range = selection.getRangeAt(0)\n      range.setEnd(endRange.endContainer, endRange.endOffset)\n    } else {\n      range = selection.getRangeAt(0)\n    }\n    const texts = getTexts(range)\n    texts.forEach(rangeString => highlightString(rangeString, rangeId))\n    rangeId = rangeId + 1\n    console.log(texts)\n    selection.collapseToStart()\n  }\n})\n\nfunction getTexts (range) {\n  const end = range.endContainer\n  const start = range.startContainer\n  const iterator = document.createNodeIterator(\n    document.getElementById('chapter'),\n    window.NodeFilter.SHOW_ALL\n  )\n  while (iterator.referenceNode !== start) {\n    iterator.nextNode()\n  }\n  const ranges = []\n  let newRange = document.createRange()\n  newRange.setStart(range.startContainer, range.startOffset)\n  while (iterator.referenceNode !== end) {\n    const ref = iterator.referenceNode\n    if (newRange && ref.matches && ref.matches('[data-reader]')) {\n      newRange.setEndBefore(ref)\n      ranges.push(newRange)\n      newRange = undefined\n      iterator.nextNode()\n    } else if (ref.parentElement.closest('[data-reader]')) {\n      iterator.nextNode()\n    } else if (!newRange) {\n      newRange = document.createRange()\n      newRange.setStartBefore(ref)\n      iterator.nextNode()\n    } else {\n      iterator.nextNode()\n    }\n  }\n  if (newRange) {\n    newRange.setEnd(end, range.endOffset)\n    ranges.push(newRange)\n  }\n  const texts = ranges.map(range => range.toString())\n  return texts\n}\n\nfunction highlightString (text, rangeId) {\n  const offset = document.body.textContent.indexOf(text)\n  const length = text.length\n  const iterator = document.createNodeIterator(\n    document.body,\n    window.NodeFilter.SHOW_TEXT\n  )\n  function split (where) {\n    const count = seek(iterator, where)\n    if (count !== where) {\n      // Split the text at the offset\n      iterator.referenceNode.splitText(where - count)\n\n      // Seek to the exact offset.\n      seek(iterator, where - count)\n    }\n    return iterator.referenceNode\n  }\n  split(offset)\n  const end = split(length)\n  const nodeCollector = document.createNodeIterator(\n    document.body,\n    window.NodeFilter.SHOW_TEXT\n  )\n  seek(nodeCollector, offset)\n  var nodes = []\n  while (nodeCollector.referenceNode !== end) {\n    nodes.push(nodeCollector.nextNode())\n  }\n  // nodes = nodes.filter((node) => !node.parentElement.matches('[data-reader]'))\n  for (var i = 0; i < nodes.length; i++) {\n    const node = nodes[i]\n    if (!node.parentElement.closest('[data-reader]')) {\n      // Create a highlight\n      const highlight = document.createElement('reader-highlight')\n      highlight.dataset.reader = true\n      highlight.dataset.rangeId = rangeId\n      highlight.classList.add('Highlight')\n\n      // Wrap it around the text node\n      node.parentNode.replaceChild(highlight, node)\n      highlight.appendChild(node)\n    }\n  }\n}\n\nwindow.highlightString = highlightString\n// Get range\n// Split text node at end and start.\n// Iterate to start\n// iterate through range, building fresh sub ranges that don't include ui elements\n// Turn arrays of ranges into flat array of strings.\n// Call highlightString on each string in array.\n// Highlight string root should be main/chapter\n","import wickedElements from 'wicked-elements'\n\nwickedElements.define('.Marker-textarea', {\n  onconnected (event) {\n    this.el = event.currentTarget\n    this.parent = this.el.closest('.Marker')\n    this.el.addEventListener('change', this)\n  },\n  onchange (event) {\n    this.parent.classList.add('Marker--hasContent')\n  }\n})\n\nwickedElements.define('[is=\"marker-note\"]', {\n  init (event) {\n    const element = (this.el = event.currentTarget)\n    const container = this.el.querySelector('.MarkerNote-textarea')\n    this.quill = new window.Quill(container, {\n      modules: {\n        toolbar: [\n          ['bold', 'italic', 'underline'],\n          ['image', 'code-block'],\n          ['link', 'blockquote'],\n          [{ list: 'ordered' }, { list: 'bullet' }],\n          ['clean']\n        ]\n      },\n      theme: 'snow'\n    })\n    this.toolbar = this.el.querySelector('.ql-toolbar')\n    const onFocus = this.onfocus\n    const onBlur = this.onblur\n    this.quill.on('selection-change', function (range, oldRange, source) {\n      if (range) {\n        onFocus(element)\n      } else {\n        onBlur(element)\n      }\n    })\n    this.quill.on('text-change', function () {\n      element.parentElement.classList.add('Marker--hasContent')\n    })\n    const button = document.createElement('button')\n    button.textContent = 'Delete'\n    button.classList.add('TextButton')\n    button.classList.add('TextButton--noteDelete')\n    button.addEventListener('click', event => {\n      this.el.parentElement.removeChild(this.el)\n    })\n    button.dataset.noteDelete = 'true'\n    this.el.appendChild(button)\n  },\n  onfocus (element) {\n    element.classList.add('MarkerNote--hasFocus')\n  },\n  onblur (element) {\n    element.classList.remove('MarkerNote--hasFocus')\n  }\n})\n\nfunction marker (xpath) {\n  const form = document.createElement('form')\n  form.setAttribute('is', 'marker-note')\n  form.dataset.for = xpath\n  form.dataset.reader = 'true'\n  form.classList.add('MarkerNote')\n  form.id = 'MarkerNote-' + xpath\n  const textareaId = 'MarkerNote-text-' + xpath\n  form.dataset.newNote = 'true'\n  form.innerHTML = `<div class=\"MarkerNote-textarea\" id=\"${textareaId}\" data-reader=\"true\" aria-label=\"Sidebar note\"></div>`\n  const button = document.createElement('button')\n  button.textContent = 'Cancel'\n  button.classList.add('TextButton')\n  button.classList.add('TextButton--noteButton')\n  button.addEventListener('click', event => {\n    form.parentElement.removeChild(form)\n  })\n  button.dataset.noteCancel = 'true'\n  form.appendChild(button)\n  return form\n}\n","import wickedElements from 'wicked-elements'\n// From https://developer.mozilla.org/en-US/docs/Web/Events/resize\nfunction throttle (type, name, obj) {\n  obj = obj || window\n  var running = false\n  const func = function () {\n    if (running) {\n      return\n    }\n    running = true\n    window.requestAnimationFrame(function () {\n      obj.dispatchEvent(new window.CustomEvent(name))\n      running = false\n    })\n  }\n  obj.addEventListener(type, func)\n}\nthrottle('resize', 'optimizedResize')\n\nwickedElements.define('#sidebar', {\n  onconnected (event) {\n    this.element = event.currentTarget\n    this.setSize()\n    window.addEventListener('optimizedResize', this)\n  },\n  onoptimizedResize () {\n    this.setSize()\n  },\n  setSize () {\n    const size = this.element.offsetWidth\n    document.body.style.setProperty('--sidebar-width', size + 'px')\n    if (size < 200) {\n      document.body.classList.add('Layout--reader-no-sidebar')\n    } else {\n      document.body.classList.remove('Layout--reader-no-sidebar')\n    }\n  }\n})\n","/*! (c) Andrea Giammarchi - ISC */\nvar self = this || /* istanbul ignore next */ {};\ntry { self.WeakMap = WeakMap; }\ncatch (WeakMap) {\n  // this could be better but 90% of the time\n  // it's everything developers need as fallback\n  self.WeakMap = (function (id, Object) {'use strict';\n    var dP = Object.defineProperty;\n    var hOP = Object.hasOwnProperty;\n    var proto = WeakMap.prototype;\n    proto.delete = function (key) {\n      return this.has(key) && delete key[this._];\n    };\n    proto.get = function (key) {\n      return this.has(key) ? key[this._] : void 0;\n    };\n    proto.has = function (key) {\n      return hOP.call(key, this._);\n    };\n    proto.set = function (key, value) {\n      dP(key, this._, {configurable: true, value: value});\n      return this;\n    };\n    return WeakMap;\n    function WeakMap(iterable) {\n      dP(this, '_', {value: '_@ungap/weakmap' + id++});\n      if (iterable)\n        iterable.forEach(add, this);\n    }\n    function add(pair) {\n      this.set(pair[0], pair[1]);\n    }\n  }(Math.random(), Object));\n}\nexport default self.WeakMap;\n","/*! (c) Andrea Giammarchi - ISC */\nvar templateLiteral = (function () {'use strict';\n  var RAW = 'raw';\n  var isNoOp = typeof document !== 'object';\n  var templateLiteral = function (tl) {\n    if (\n      // for badly transpiled literals\n      !(RAW in tl) ||\n      // for some version of TypeScript\n      tl.propertyIsEnumerable(RAW) ||\n      // and some other version of TypeScript\n      !Object.isFrozen(tl[RAW]) ||\n      (\n        // or for Firefox < 55\n        /Firefox\\/(\\d+)/.test(\n          (document.defaultView.navigator || {}).userAgent\n        ) &&\n        parseFloat(RegExp.$1) < 55\n      )\n    ) {\n      var forever = {};\n      templateLiteral = function (tl) {\n        for (var key = '.', i = 0; i < tl.length; i++)\n          key += tl[i].length + '.' + tl[i];\n        return forever[key] || (forever[key] = tl);\n      };\n    } else {\n      isNoOp = true;\n    }\n    return TL(tl);\n  };\n  return TL;\n  function TL(tl) {\n    return isNoOp ? tl : templateLiteral(tl);\n  }\n}());\nexport default templateLiteral;\n","import unique from '@ungap/template-literal';\n\nexport default function (template) {\n  var length = arguments.length;\n  var args = [unique(template)];\n  var i = 1;\n  while (i < length)\n    args.push(arguments[i++]);\n  return args;\n};\n","/*! (c) Andrea Giammarchi - ISC */\nvar Wire = (function (slice, proto) {\n\n  proto = Wire.prototype;\n\n  proto.ELEMENT_NODE = 1;\n  proto.nodeType = 111;\n\n  proto.remove = function (keepFirst) {\n    var childNodes = this.childNodes;\n    var first = this.firstChild;\n    var last = this.lastChild;\n    this._ = null;\n    if (keepFirst && childNodes.length === 2) {\n      last.parentNode.removeChild(last);\n    } else {\n      var range = this.ownerDocument.createRange();\n      range.setStartBefore(keepFirst ? childNodes[1] : first);\n      range.setEndAfter(last);\n      range.deleteContents();\n    }\n    return first;\n  };\n\n  proto.valueOf = function (forceAppend) {\n    var fragment = this._;\n    var noFragment = fragment == null;\n    if (noFragment)\n      fragment = (this._ = this.ownerDocument.createDocumentFragment());\n    if (noFragment || forceAppend) {\n      for (var n = this.childNodes, i = 0, l = n.length; i < l; i++)\n        fragment.appendChild(n[i]);\n    }\n    return fragment;\n  };\n\n  return Wire;\n\n  function Wire(childNodes) {\n    var nodes = (this.childNodes = slice.call(childNodes, 0));\n    this.firstChild = nodes[0];\n    this.lastChild = nodes[nodes.length - 1];\n    this.ownerDocument = nodes[0].ownerDocument;\n    this._ = null;\n  }\n\n}([].slice));\nexport default Wire;\n","import Wire from 'hyperhtml-wire';\n\nconst {isArray} = Array;\nconst wireType = Wire.prototype.nodeType;\n\nexport {\n  Wire,\n  isArray,\n  wireType\n};\n","/*! (c) Andrea Giammarchi - ISC */\nvar createContent = (function (document) {'use strict';\n  var FRAGMENT = 'fragment';\n  var TEMPLATE = 'template';\n  var HAS_CONTENT = 'content' in create(TEMPLATE);\n\n  var createHTML = HAS_CONTENT ?\n    function (html) {\n      var template = create(TEMPLATE);\n      template.innerHTML = html;\n      return template.content;\n    } :\n    function (html) {\n      var content = create(FRAGMENT);\n      var template = create(TEMPLATE);\n      var childNodes = null;\n      if (/^[^\\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(html)) {\n        var selector = RegExp.$1;\n        template.innerHTML = '<table>' + html + '</table>';\n        childNodes = template.querySelectorAll(selector);\n      } else {\n        template.innerHTML = html;\n        childNodes = template.childNodes;\n      }\n      append(content, childNodes);\n      return content;\n    };\n\n  return function createContent(markup, type) {\n    return (type === 'svg' ? createSVG : createHTML)(markup);\n  };\n\n  function append(root, childNodes) {\n    var length = childNodes.length;\n    while (length--)\n      root.appendChild(childNodes[0]);\n  }\n\n  function create(element) {\n    return element === FRAGMENT ?\n      document.createDocumentFragment() :\n      document.createElementNS('http://www.w3.org/1999/xhtml', element);\n  }\n\n  // it could use createElementNS when hasNode is there\n  // but this fallback is equally fast and easier to maintain\n  // it is also battle tested already in all IE\n  function createSVG(svg) {\n    var content = create(FRAGMENT);\n    var template = create('div');\n    template.innerHTML = '<svg xmlns=\"http://www.w3.org/2000/svg\">' + svg + '</svg>';\n    append(content, template.firstChild.childNodes);\n    return content;\n  }\n\n}(document));\nexport default createContent;\n","/*! (c) Andrea Giammarchi - ISC */\nvar self = this || /* istanbul ignore next */ {};\ntry { self.Map = Map; }\ncatch (Map) {\n  self.Map = function Map() {\n    var i = 0;\n    var k = [];\n    var v = [];\n    return {\n      delete: function (key) {\n        var had = contains(key);\n        if (had) {\n          k.splice(i, 1);\n          v.splice(i, 1);\n        }\n        return had;\n      },\n      get: function get(key) {\n        return contains(key) ? v[i] : void 0;\n      },\n      has: function has(key) {\n        return contains(key);\n      },\n      set: function set(key, value) {\n        v[contains(key) ? i : (k.push(key) - 1)] = value;\n        return this;\n      }\n    };\n    function contains(v) {\n      i = k.indexOf(v);\n      return -1 < i;\n    }\n  };\n}\nexport default self.Map;\n","import Map from '@ungap/essential-map';\n\nexport const append = (get, parent, children, start, end, before) => {\n  if ((end - start) < 2)\n    parent.insertBefore(get(children[start], 1), before);\n  else {\n    const fragment = parent.ownerDocument.createDocumentFragment();\n    while (start < end)\n      fragment.appendChild(get(children[start++], 1));\n    parent.insertBefore(fragment, before);\n  }\n};\n\nexport const eqeq = (a, b) => a == b;\n\nexport const identity = O => O;\n\nexport const indexOf = (\n  moreNodes,\n  moreStart,\n  moreEnd,\n  lessNodes,\n  lessStart,\n  lessEnd,\n  compare\n) => {\n  const length = lessEnd - lessStart;\n  /* istanbul ignore if */\n  if (length < 1)\n    return -1;\n  while ((moreEnd - moreStart) >= length) {\n    let m = moreStart;\n    let l = lessStart;\n    while (\n      m < moreEnd &&\n      l < lessEnd &&\n      compare(moreNodes[m], lessNodes[l])\n    ) {\n      m++;\n      l++;\n    }\n    if (l === lessEnd)\n      return moreStart;\n    moreStart = m + 1;\n  }\n  return -1;\n};\n\nexport const isReversed = (\n  futureNodes,\n  futureEnd,\n  currentNodes,\n  currentStart,\n  currentEnd,\n  compare\n) => {\n  while (\n    currentStart < currentEnd &&\n    compare(\n      currentNodes[currentStart],\n      futureNodes[futureEnd - 1]\n    )) {\n      currentStart++;\n      futureEnd--;\n    };\n  return futureEnd === 0;\n};\n\nexport const next = (get, list, i, length, before) => i < length ?\n              get(list[i], 0) :\n              (0 < i ?\n                get(list[i - 1], -0).nextSibling :\n                before);\n\nexport const remove = (get, parent, children, start, end) => {\n  if ((end - start) < 2)\n    parent.removeChild(get(children[start], -1));\n  else {\n    const range = parent.ownerDocument.createRange();\n    range.setStartBefore(get(children[start], -1));\n    range.setEndAfter(get(children[end - 1], -1));\n    range.deleteContents();\n  }\n};\n\n// - - - - - - - - - - - - - - - - - - -\n// diff related constants and utilities\n// - - - - - - - - - - - - - - - - - - -\n\nconst DELETION = -1;\nconst INSERTION = 1;\nconst SKIP = 0;\nconst SKIP_OND = 50;\n\nconst HS = (\n  futureNodes,\n  futureStart,\n  futureEnd,\n  futureChanges,\n  currentNodes,\n  currentStart,\n  currentEnd,\n  currentChanges\n) => {\n\n  let k = 0;\n  /* istanbul ignore next */\n  let minLen = futureChanges < currentChanges ? futureChanges : currentChanges;\n  const link = Array(minLen++);\n  const tresh = Array(minLen);\n  tresh[0] = -1;\n\n  for (let i = 1; i < minLen; i++)\n    tresh[i] = currentEnd;\n\n  const keymap = new Map;\n  for (let i = currentStart; i < currentEnd; i++)\n    keymap.set(currentNodes[i], i);\n\n  for (let i = futureStart; i < futureEnd; i++) {\n    const idxInOld = keymap.get(futureNodes[i]);\n    if (idxInOld != null) {\n      k = findK(tresh, minLen, idxInOld);\n      /* istanbul ignore else */\n      if (-1 < k) {\n        tresh[k] = idxInOld;\n        link[k] = {\n          newi: i,\n          oldi: idxInOld,\n          prev: link[k - 1]\n        };\n      }\n    }\n  }\n\n  k = --minLen;\n  --currentEnd;\n  while (tresh[k] > currentEnd) --k;\n\n  minLen = currentChanges + futureChanges - k;\n  const diff = Array(minLen);\n  let ptr = link[k];\n  --futureEnd;\n  while (ptr) {\n    const {newi, oldi} = ptr;\n    while (futureEnd > newi) {\n      diff[--minLen] = INSERTION;\n      --futureEnd;\n    }\n    while (currentEnd > oldi) {\n      diff[--minLen] = DELETION;\n      --currentEnd;\n    }\n    diff[--minLen] = SKIP;\n    --futureEnd;\n    --currentEnd;\n    ptr = ptr.prev;\n  }\n  while (futureEnd >= futureStart) {\n    diff[--minLen] = INSERTION;\n    --futureEnd;\n  }\n  while (currentEnd >= currentStart) {\n    diff[--minLen] = DELETION;\n    --currentEnd;\n  }\n  return diff;\n};\n\n// this is pretty much the same petit-dom code without the delete map part\n// https://github.com/yelouafi/petit-dom/blob/bd6f5c919b5ae5297be01612c524c40be45f14a7/src/vdom.js#L556-L561\nconst OND = (\n  futureNodes,\n  futureStart,\n  rows,\n  currentNodes,\n  currentStart,\n  cols,\n  compare\n) => {\n  const length = rows + cols;\n  const v = [];\n  let d, k, r, c, pv, cv, pd;\n  outer: for (d = 0; d <= length; d++) {\n    /* istanbul ignore if */\n    if (d > SKIP_OND)\n      return null;\n    pd = d - 1;\n    /* istanbul ignore next */\n    pv = d ? v[d - 1] : [0, 0];\n    cv = v[d] = [];\n    for (k = -d; k <= d; k += 2) {\n      if (k === -d || (k !== d && pv[pd + k - 1] < pv[pd + k + 1])) {\n        c = pv[pd + k + 1];\n      } else {\n        c = pv[pd + k - 1] + 1;\n      }\n      r = c - k;\n      while (\n        c < cols &&\n        r < rows &&\n        compare(\n          currentNodes[currentStart + c],\n          futureNodes[futureStart + r]\n        )\n      ) {\n        c++;\n        r++;\n      }\n      if (c === cols && r === rows) {\n        break outer;\n      }\n      cv[d + k] = c;\n    }\n  }\n\n  const diff = Array(d / 2 + length / 2);\n  let diffIdx = diff.length - 1;\n  for (d = v.length - 1; d >= 0; d--) {\n    while (\n      c > 0 &&\n      r > 0 &&\n      compare(\n        currentNodes[currentStart + c - 1],\n        futureNodes[futureStart + r - 1]\n      )\n    ) {\n      // diagonal edge = equality\n      diff[diffIdx--] = SKIP;\n      c--;\n      r--;\n    }\n    if (!d)\n      break;\n    pd = d - 1;\n    /* istanbul ignore next */\n    pv = d ? v[d - 1] : [0, 0];\n    k = c - r;\n    if (k === -d || (k !== d && pv[pd + k - 1] < pv[pd + k + 1])) {\n      // vertical edge = insertion\n      r--;\n      diff[diffIdx--] = INSERTION;\n    } else {\n      // horizontal edge = deletion\n      c--;\n      diff[diffIdx--] = DELETION;\n    }\n  }\n  return diff;\n};\n\nconst applyDiff = (\n  diff,\n  get,\n  parentNode,\n  futureNodes,\n  futureStart,\n  currentNodes,\n  currentStart,\n  currentLength,\n  before\n) => {\n  const live = new Map;\n  const length = diff.length;\n  let currentIndex = currentStart;\n  let i = 0;\n  while (i < length) {\n    switch (diff[i++]) {\n      case SKIP:\n        futureStart++;\n        currentIndex++;\n        break;\n      case INSERTION:\n        // TODO: bulk appends for sequential nodes\n        live.set(futureNodes[futureStart], 1);\n        append(\n          get,\n          parentNode,\n          futureNodes,\n          futureStart++,\n          futureStart,\n          currentIndex < currentLength ?\n            get(currentNodes[currentIndex], 0) :\n            before\n        );\n        break;\n      case DELETION:\n        currentIndex++;\n        break;\n    }\n  }\n  i = 0;\n  while (i < length) {\n    switch (diff[i++]) {\n      case SKIP:\n        currentStart++;\n        break;\n      case DELETION:\n        // TODO: bulk removes for sequential nodes\n        if (live.has(currentNodes[currentStart]))\n          currentStart++;\n        else\n          remove(\n            get,\n            parentNode,\n            currentNodes,\n            currentStart++,\n            currentStart\n          );\n        break;\n    }\n  }\n};\n\nconst findK = (ktr, length, j) => {\n  let lo = 1;\n  let hi = length;\n  while (lo < hi) {\n    const mid = ((lo + hi) / 2) >>> 0;\n    if (j < ktr[mid])\n      hi = mid;\n    else\n      lo = mid + 1;\n  }\n  return lo;\n}\n\nexport const smartDiff = (\n  get,\n  parentNode,\n  futureNodes,\n  futureStart,\n  futureEnd,\n  futureChanges,\n  currentNodes,\n  currentStart,\n  currentEnd,\n  currentChanges,\n  currentLength,\n  compare,\n  before\n) => {\n  applyDiff(\n    OND(\n      futureNodes,\n      futureStart,\n      futureChanges,\n      currentNodes,\n      currentStart,\n      currentChanges,\n      compare\n    ) ||\n    HS(\n      futureNodes,\n      futureStart,\n      futureEnd,\n      futureChanges,\n      currentNodes,\n      currentStart,\n      currentEnd,\n      currentChanges\n    ),\n    get,\n    parentNode,\n    futureNodes,\n    futureStart,\n    currentNodes,\n    currentStart,\n    currentLength,\n    before\n  );\n};\n","/*! (c) 2018 Andrea Giammarchi (ISC) */\n\nimport {\n  eqeq, identity, indexOf, isReversed, next,\n  append, remove,\n  smartDiff\n} from './utils.js';\n\nconst domdiff = (\n  parentNode,     // where changes happen\n  currentNodes,   // Array of current items/nodes\n  futureNodes,    // Array of future items/nodes\n  options         // optional object with one of the following properties\n                  //  before: domNode\n                  //  compare(generic, generic) => true if same generic\n                  //  node(generic) => Node\n) => {\n  if (!options)\n    options = {};\n\n  const compare = options.compare || eqeq;\n  const get = options.node || identity;\n  const before = options.before == null ? null : get(options.before, 0);\n\n  const currentLength = currentNodes.length;\n  let currentEnd = currentLength;\n  let currentStart = 0;\n\n  let futureEnd = futureNodes.length;\n  let futureStart = 0;\n\n  // common prefix\n  while (\n    currentStart < currentEnd &&\n    futureStart < futureEnd &&\n    compare(currentNodes[currentStart], futureNodes[futureStart])\n  ) {\n    currentStart++;\n    futureStart++;\n  }\n\n  // common suffix\n  while (\n    currentStart < currentEnd &&\n    futureStart < futureEnd &&\n    compare(currentNodes[currentEnd - 1], futureNodes[futureEnd - 1])\n  ) {\n    currentEnd--;\n    futureEnd--;\n  }\n\n  const currentSame = currentStart === currentEnd;\n  const futureSame = futureStart === futureEnd;\n\n  // same list\n  if (currentSame && futureSame)\n    return futureNodes;\n\n  // only stuff to add\n  if (currentSame && futureStart < futureEnd) {\n    append(\n      get,\n      parentNode,\n      futureNodes,\n      futureStart,\n      futureEnd,\n      next(get, currentNodes, currentStart, currentLength, before)\n    );\n    return futureNodes;\n  }\n\n  // only stuff to remove\n  if (futureSame && currentStart < currentEnd) {\n    remove(\n      get,\n      parentNode,\n      currentNodes,\n      currentStart,\n      currentEnd\n    );\n    return futureNodes;\n  }\n\n  const currentChanges = currentEnd - currentStart;\n  const futureChanges = futureEnd - futureStart;\n  let i = -1;\n\n  // 2 simple indels: the shortest sequence is a subsequence of the longest\n  if (currentChanges < futureChanges) {\n    i = indexOf(\n      futureNodes,\n      futureStart,\n      futureEnd,\n      currentNodes,\n      currentStart,\n      currentEnd,\n      compare\n    );\n    // inner diff\n    if (-1 < i) {\n      append(\n        get,\n        parentNode,\n        futureNodes,\n        futureStart,\n        i,\n        get(currentNodes[currentStart], 0)\n      );\n      append(\n        get,\n        parentNode,\n        futureNodes,\n        i + currentChanges,\n        futureEnd,\n        next(get, currentNodes, currentEnd, currentLength, before)\n      );\n      return futureNodes;\n    }\n  }\n  /* istanbul ignore else */\n  else if (futureChanges < currentChanges) {\n    i = indexOf(\n      currentNodes,\n      currentStart,\n      currentEnd,\n      futureNodes,\n      futureStart,\n      futureEnd,\n      compare\n    );\n    // outer diff\n    if (-1 < i) {\n      remove(\n        get,\n        parentNode,\n        currentNodes,\n        currentStart,\n        i\n      );\n      remove(\n        get,\n        parentNode,\n        currentNodes,\n        i + futureChanges,\n        currentEnd\n      );\n      return futureNodes;\n    }\n  }\n\n  // common case with one replacement for many nodes\n  // or many nodes replaced for a single one\n  /* istanbul ignore else */\n  if ((currentChanges < 2 || futureChanges < 2)) {\n    append(\n      get,\n      parentNode,\n      futureNodes,\n      futureStart,\n      futureEnd,\n      get(currentNodes[currentStart], 0)\n    );\n    remove(\n      get,\n      parentNode,\n      currentNodes,\n      currentStart,\n      currentEnd\n    );\n    return futureNodes;\n  }\n\n  // the half match diff part has been skipped in petit-dom\n  // https://github.com/yelouafi/petit-dom/blob/bd6f5c919b5ae5297be01612c524c40be45f14a7/src/vdom.js#L391-L397\n  // accordingly, I think it's safe to skip in here too\n  // if one day it'll come out like the speediest thing ever to do\n  // then I might add it in here too\n\n  // Extra: before going too fancy, what about reversed lists ?\n  //        This should bail out pretty quickly if that's not the case.\n  if (\n    currentChanges === futureChanges &&\n    isReversed(\n      futureNodes,\n      futureEnd,\n      currentNodes,\n      currentStart,\n      currentEnd,\n      compare\n    )\n  ) {\n    append(\n      get,\n      parentNode,\n      futureNodes,\n      futureStart,\n      futureEnd,\n      next(get, currentNodes, currentEnd, currentLength, before)\n    );\n    return futureNodes;\n  }\n\n  // last resort through a smart diff\n  smartDiff(\n    get,\n    parentNode,\n    futureNodes,\n    futureStart,\n    futureEnd,\n    futureChanges,\n    currentNodes,\n    currentStart,\n    currentEnd,\n    currentChanges,\n    currentLength,\n    compare,\n    before\n  );\n\n  return futureNodes;\n};\n\nexport default domdiff;\n","/*! (c) Andrea Giammarchi - ISC */\nvar importNode = (function (\n  document,\n  appendChild,\n  cloneNode,\n  createTextNode,\n  importNode\n) {\n  var native = importNode in document;\n  // IE 11 has problems with cloning templates:\n  // it \"forgets\" empty childNodes. This feature-detects that.\n  var fragment = document.createDocumentFragment();\n  fragment[appendChild](document[createTextNode]('g'));\n  fragment[appendChild](document[createTextNode](''));\n  var content = native ?\n    document[importNode](fragment, true) :\n    fragment[cloneNode](true);\n  return content.childNodes.length < 2 ?\n    function importNode(node, deep) {\n      var clone = node[cloneNode]();\n      for (var\n        childNodes = node.childNodes || [],\n        length = childNodes.length,\n        i = 0; deep && i < length; i++\n      ) {\n        clone[appendChild](importNode(childNodes[i], deep));\n      }\n      return clone;\n    } :\n    (native ?\n      document[importNode] :\n      function (node, deep) {\n        return node[cloneNode](!!deep);\n      }\n    );\n}(\n  document,\n  'appendChild',\n  'cloneNode',\n  'createTextNode',\n  'importNode'\n));\nexport default importNode;\n","// Custom\nvar UID = '-' + Math.random().toFixed(6) + '%';\n//                           Edge issue!\nif (!(function (template, content, tabindex) {\n  return content in template && (\n    (template.innerHTML = '<p ' + tabindex + '=\"' + UID + '\"></p>'),\n    template[content].childNodes[0].getAttribute(tabindex) == UID\n  );\n}(document.createElement('template'), 'content', 'tabindex'))) {\n  UID = '_dt: ' + UID.slice(1, -1) + ';';\n}\nvar UIDC = '<!--' + UID + '-->';\n\n// DOM\nvar COMMENT_NODE = 8;\nvar DOCUMENT_FRAGMENT_NODE = 11;\nvar ELEMENT_NODE = 1;\nvar TEXT_NODE = 3;\n\nvar SHOULD_USE_TEXT_CONTENT = /^(?:style|textarea)$/i;\nvar VOID_ELEMENTS = /^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i;\n\nexport {\n  UID, UIDC,\n  COMMENT_NODE,\n  DOCUMENT_FRAGMENT_NODE,\n  ELEMENT_NODE,\n  TEXT_NODE,\n  SHOULD_USE_TEXT_CONTENT,\n  VOID_ELEMENTS\n};\n","var trim = ''.trim || function () {\n  return String(this).replace(/^\\s+|\\s+/g, '');\n};\nexport default trim;\n","import {UID, UIDC, VOID_ELEMENTS} from './constants.js';\n\nexport default function (template) {\n  return template.join(UIDC)\n          .replace(selfClosing, fullClosing)\n          .replace(attrSeeker, attrReplacer);\n}\n\nvar spaces = ' \\\\f\\\\n\\\\r\\\\t';\nvar almostEverything = '[^ ' + spaces + '\\\\/>\"\\'=]+';\nvar attrName = '[ ' + spaces + ']+' + almostEverything;\nvar tagName = '<([A-Za-z]+[A-Za-z0-9:_-]*)((?:';\nvar attrPartials = '(?:\\\\s*=\\\\s*(?:\\'[^\\']*?\\'|\"[^\"]*?\"|<[^>]*?>|' + almostEverything + '))?)';\n\nvar attrSeeker = new RegExp(tagName + attrName + attrPartials + '+)([ ' + spaces + ']*/?>)', 'g');\nvar selfClosing = new RegExp(tagName + attrName + attrPartials + '*)([ ' + spaces + ']*/>)', 'g');\nvar findAttributes = new RegExp('(' + attrName + '\\\\s*=\\\\s*)([\\'\"]?)' + UIDC + '\\\\2', 'gi');\n\nfunction attrReplacer($0, $1, $2, $3) {\n  return '<' + $1 + $2.replace(findAttributes, replaceAttributes) + $3;\n}\n\nfunction replaceAttributes($0, $1, $2) {\n  return $1 + ($2 || '\"') + UID + ($2 || '\"');\n}\n\nfunction fullClosing($0, $1, $2) {\n  return VOID_ELEMENTS.test($1) ? $0 : ('<' + $1 + $2 + '></' + $1 + '>');\n}\n","import Map from '@ungap/essential-map';\nimport trim from '@ungap/trim';\n\nimport {\n  UID, UIDC,\n  COMMENT_NODE,\n  ELEMENT_NODE,\n  SHOULD_USE_TEXT_CONTENT,\n  TEXT_NODE\n} from './constants.js';\n\nexport {find, parse};\n\nfunction create(type, node, path, name) {\n  return {name: name, node: node, path: path, type: type};\n}\n\nfunction find(node, path) {\n  var length = path.length;\n  var i = 0;\n  while (i < length)\n    node = node.childNodes[path[i++]];\n  return node;\n}\n\nfunction parse(node, holes, parts, path) {\n  var childNodes = node.childNodes;\n  var length = childNodes.length;\n  var i = 0;\n  while (i < length) {\n    var child = childNodes[i];\n    switch (child.nodeType) {\n      case ELEMENT_NODE:\n        var childPath = path.concat(i);\n        parseAttributes(child, holes, parts, childPath);\n        parse(child, holes, parts, childPath);\n        break;\n      case COMMENT_NODE:\n        if (child.textContent === UID) {\n          parts.shift();\n          holes.push(\n            // basicHTML or other non standard engines\n            // might end up having comments in nodes\n            // where they shouldn't, hence this check.\n            SHOULD_USE_TEXT_CONTENT.test(node.nodeName) ?\n              create('text', node, path) :\n              create('any', child, path.concat(i))\n          );\n        }\n        break;\n      case TEXT_NODE:\n        // the following ignore is actually covered by browsers\n        // only basicHTML ends up on previous COMMENT_NODE case\n        // instead of TEXT_NODE because it knows nothing about\n        // special style or textarea behavior\n        /* istanbul ignore if */\n        if (\n          SHOULD_USE_TEXT_CONTENT.test(node.nodeName) &&\n          trim.call(child.textContent) === UIDC\n        ) {\n          parts.shift();\n          holes.push(create('text', node, path));\n        }\n        break;\n    }\n    i++;\n  }\n}\n\nfunction parseAttributes(node, holes, parts, path) {\n  var cache = new Map;\n  var attributes = node.attributes;\n  var remove = [];\n  var array = remove.slice.call(attributes, 0);\n  var length = array.length;\n  var i = 0;\n  while (i < length) {\n    var attribute = array[i++];\n    if (attribute.value === UID) {\n      var name = attribute.name;\n      // the following ignore is covered by IE\n      // and the IE9 double viewBox test\n      /* istanbul ignore else */\n      if (!cache.has(name)) {\n        var realName = parts.shift().replace(/^(?:|[\\S\\s]*?\\s)(\\S+?)\\s*=\\s*['\"]?$/, '$1');\n        var value = attributes[realName] ||\n                      // the following ignore is covered by browsers\n                      // while basicHTML is already case-sensitive\n                      /* istanbul ignore next */\n                      attributes[realName.toLowerCase()];\n        cache.set(name, value);\n        holes.push(create('attr', value, path, realName));\n      }\n      remove.push(attribute);\n    }\n  }\n  length = remove.length;\n  i = 0;\n  while (i < length) {\n    // Edge HTML bug #16878726\n    var attr = remove[i++];\n    if (/^id$/i.test(attr.name))\n      node.removeAttribute(attr.name);\n    // standard browsers would work just fine here\n    else\n      node.removeAttributeNode(attr);\n  }\n\n  // This is a very specific Firefox/Safari issue\n  // but since it should be a not so common pattern,\n  // it's probably worth patching regardless.\n  // Basically, scripts created through strings are death.\n  // You need to create fresh new scripts instead.\n  // TODO: is there any other node that needs such nonsense?\n  var nodeName = node.nodeName;\n  if (/^script$/i.test(nodeName)) {\n    // this used to be like that\n    // var script = createElement(node, nodeName);\n    // then Edge arrived and decided that scripts created\n    // through template documents aren't worth executing\n    // so it became this ... hopefully it won't hurt in the wild\n    var script = document.createElement(nodeName);\n    length = attributes.length;\n    i = 0;\n    while (i < length)\n      script.setAttributeNode(attributes[i++].cloneNode(true));\n    script.textContent = node.textContent;\n    node.parentNode.replaceChild(script, node);\n  }\n}\n","// globals\nimport WeakMap from '@ungap/weakmap';\n\n// utils\nimport createContent from '@ungap/create-content';\nimport importNode from '@ungap/import-node';\nimport trim from '@ungap/trim';\n\n// local\nimport sanitize from './sanitizer.js';\nimport {find, parse} from './walker.js';\n\n// the domtagger 🎉\nexport default domtagger;\n\nvar parsed = new WeakMap;\nvar referenced = new WeakMap;\n\nfunction createInfo(options, template) {\n  var markup = sanitize(template);\n  var transform = options.transform;\n  if (transform)\n    markup = transform(markup);\n  var content = createContent(markup, options.type);\n  cleanContent(content);\n  var holes = [];\n  parse(content, holes, template.slice(0), []);\n  var info = {\n    content: content,\n    updates: function (content) {\n      var callbacks = [];\n      var len = holes.length;\n      var i = 0;\n      while (i < len) {\n        var info = holes[i++];\n        var node = find(content, info.path);\n        switch (info.type) {\n          case 'any':\n            callbacks.push(options.any(node, []));\n            break;\n          case 'attr':\n            callbacks.push(options.attribute(node, info.name, info.node));\n            break;\n          case 'text':\n            callbacks.push(options.text(node));\n            node.textContent = '';\n            break;\n        }\n      }\n      return function () {\n        var length = arguments.length;\n        var values = length - 1;\n        var i = 1;\n        if (len !== values) {\n          throw new Error(\n            values + ' values instead of ' + len + '\\n' +\n            template.join(', ')\n          );\n        }\n        while (i < length)\n          callbacks[i - 1](arguments[i++]);\n        return content;\n      };\n    }\n  };\n  parsed.set(template, info);\n  return info;\n}\n\nfunction createDetails(options, template) {\n  var info = parsed.get(template) || createInfo(options, template);\n  var content = importNode.call(document, info.content, true);\n  var details = {\n    content: content,\n    template: template,\n    updates: info.updates(content)\n  };\n  referenced.set(options, details);\n  return details;\n}\n\nfunction domtagger(options) {\n  return function (template) {\n    var details = referenced.get(options);\n    if (details == null || details.template !== template)\n      details = createDetails(options, template);\n    details.updates.apply(null, arguments);\n    return details.content;\n  };\n}\n\nfunction cleanContent(fragment) {\n  var childNodes = fragment.childNodes;\n  var i = childNodes.length;\n  while (i--) {\n    var child = childNodes[i];\n    if (\n      child.nodeType !== 1 &&\n      trim.call(child.textContent).length === 0\n    ) {\n      fragment.removeChild(child);\n    }\n  }\n}\n","/*! (c) Andrea Giammarchi - ISC */\nvar hyperStyle = (function (){'use strict';\n  // from https://github.com/developit/preact/blob/33fc697ac11762a1cb6e71e9847670d047af7ce5/src/varants.js\n  var IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i;\n  var hyphen = /([^A-Z])([A-Z]+)/g;\n  return function hyperStyle(node, original) {\n    return 'ownerSVGElement' in node ? svg(node, original) : update(node.style, false);\n  };\n  function ized($0, $1, $2) {\n    return $1 + '-' + $2.toLowerCase();\n  }\n  function svg(node, original) {\n    var style;\n    if (original)\n      style = original.cloneNode(true);\n    else {\n      node.setAttribute('style', '--hyper:style;');\n      style = node.getAttributeNode('style');\n    }\n    style.value = '';\n    node.setAttributeNode(style);\n    return update(style, true);\n  }\n  function toStyle(object) {\n    var key, css = [];\n    for (key in object)\n      css.push(key.replace(hyphen, ized), ':', object[key], ';');\n    return css.join('');\n  }\n  function update(style, isSVG) {\n    var oldType, oldValue;\n    return function (newValue) {\n      var info, key, styleValue, value;\n      switch (typeof newValue) {\n        case 'object':\n          if (newValue) {\n            if (oldType === 'object') {\n              if (!isSVG) {\n                if (oldValue !== newValue) {\n                  for (key in oldValue) {\n                    if (!(key in newValue)) {\n                      style[key] = '';\n                    }\n                  }\n                }\n              }\n            } else {\n              if (isSVG)\n                style.value = '';\n              else\n                style.cssText = '';\n            }\n            info = isSVG ? {} : style;\n            for (key in newValue) {\n              value = newValue[key];\n              styleValue = typeof value === 'number' &&\n                                  !IS_NON_DIMENSIONAL.test(key) ?\n                                  (value + 'px') : value;\n              if (!isSVG && /^--/.test(key))\n                info.setProperty(key, styleValue);\n              else\n                info[key] = styleValue;\n            }\n            oldType = 'object';\n            if (isSVG)\n              style.value = toStyle((oldValue = info));\n            else\n              oldValue = newValue;\n            break;\n          }\n        default:\n          if (oldValue != newValue) {\n            oldType = 'string';\n            oldValue = newValue;\n            if (isSVG)\n              style.value = newValue || '';\n            else\n              style.cssText = newValue || '';\n          }\n          break;\n      }\n    };\n  }\n}());\nexport default hyperStyle;\n","import createContent from '@ungap/create-content';\nimport domdiff from 'domdiff';\nimport domtagger from 'domtagger';\nimport hyperStyle from 'hyperhtml-style';\n\nimport {wireType, isArray} from './shared.js';\n\nconst OWNER_SVG_ELEMENT = 'ownerSVGElement';\n\n// returns nodes from wires and components\nconst asNode = (item, i) => item.nodeType === wireType ?\n  (\n    (1 / i) < 0 ?\n      (i ? item.remove(true) : item.lastChild) :\n      (i ? item.valueOf(true) : item.firstChild)\n  ) :\n  item\n;\n\n// returns true if domdiff can handle the value\nconst canDiff = value => 'ELEMENT_NODE' in value;\n\n// generic attributes helpers\nconst hyperAttribute = (node, attribute) => {\n  let oldValue;\n  let owner = false;\n  return newValue => {\n    if (oldValue !== newValue) {\n      oldValue = newValue;\n      if (attribute.value !== newValue) {\n        if (newValue == null) {\n          if (owner) {\n            owner = false;\n            node.removeAttributeNode(attribute);\n          }\n          attribute.value = newValue;\n        } else {\n          attribute.value = newValue;\n          if (!owner) {\n            owner = true;\n            node.setAttributeNode(attribute);\n          }\n        }\n      }\n    }\n  };\n};\n\n// events attributes helpers\nconst hyperEvent = (node, name) => {\n  let oldValue;\n  let type = name.slice(2);\n  if (name.toLowerCase() in node)\n    type = type.toLowerCase();\n  return newValue => {\n    if (oldValue !== newValue) {\n      if (oldValue)\n        node.removeEventListener(type, oldValue, false);\n      oldValue = newValue;\n      if (newValue)\n        node.addEventListener(type, newValue, false);\n    }\n  };\n};\n\n// special attributes helpers\nconst hyperProperty = (node, name) => {\n  let oldValue;\n  return newValue => {\n    if (oldValue !== newValue) {\n      oldValue = newValue;\n      if (node[name] !== newValue) {\n        node[name] = newValue;\n        if (newValue == null) {\n          node.removeAttribute(name);\n        }\n      }\n    }\n  };\n};\n\n// special hooks helpers\nconst hyperRef = node => {\n  return ref => {\n    ref.current = node;\n  };\n};\n\n// list of attributes that should not be directly assigned\nconst readOnly = /^(?:form|list)$/i;\n\n// reused every slice time\nconst slice = [].slice;\n\n// simplifies text node creation\nconst text = (node, text) => node.ownerDocument.createTextNode(text);\n\nexport default function Tagger(type) {\n  this.type = type;\n  return domtagger(this);\n}\n\nTagger.prototype = {\n\n  // there are four kind of attributes, and related behavior:\n  //  * events, with a name starting with `on`, to add/remove event listeners\n  //  * special, with a name present in their inherited prototype, accessed directly\n  //  * regular, accessed through get/setAttribute standard DOM methods\n  //  * style, the only regular attribute that also accepts an object as value\n  //    so that you can style=${{width: 120}}. In this case, the behavior has been\n  //    fully inspired by Preact library and its simplicity.\n  attribute(node, name, original) {\n    switch (name) {\n      case 'class':\n        name = 'className';\n      case 'data':\n      case 'props':\n        return hyperProperty(node, name);\n      case 'style':\n        return hyperStyle(node, original, OWNER_SVG_ELEMENT in node);\n      case 'ref':\n        return hyperRef(node);\n      default:\n        if (name.slice(0, 2) === 'on')\n          return hyperEvent(node, name);\n        if (name in node && !(\n          OWNER_SVG_ELEMENT in node || readOnly.test(name)\n        ))\n          return hyperProperty(node, name);\n        return hyperAttribute(node, original.cloneNode(true));\n\n    }\n  },\n\n  // in a hyper(node)`<div>${content}</div>` case\n  // everything could happen:\n  //  * it's a JS primitive, stored as text\n  //  * it's null or undefined, the node should be cleaned\n  //  * it's a promise, update the content once resolved\n  //  * it's an explicit intent, perform the desired operation\n  //  * it's an Array, resolve all values if Promises and/or\n  //    update the node with the resulting list of content\n  any(node, childNodes) {\n    const diffOptions = {node: asNode, before: node};\n    const nodeType = OWNER_SVG_ELEMENT in node ? /* istanbul ignore next */ 'svg' : 'html';\n    let fastPath = false;\n    let oldValue;\n    const anyContent = value => {\n      switch (typeof value) {\n        case 'string':\n        case 'number':\n        case 'boolean':\n          if (fastPath) {\n            if (oldValue !== value) {\n              oldValue = value;\n              childNodes[0].textContent = value;\n            }\n          } else {\n            fastPath = true;\n            oldValue = value;\n            childNodes = domdiff(\n              node.parentNode,\n              childNodes,\n              [text(node, value)],\n              diffOptions\n            );\n          }\n          break;\n        case 'function':\n          anyContent(value(node));\n          break;\n        case 'object':\n        case 'undefined':\n          if (value == null) {\n            fastPath = false;\n            childNodes = domdiff(\n              node.parentNode,\n              childNodes,\n              [],\n              diffOptions\n            );\n            break;\n          }\n        default:\n          fastPath = false;\n          oldValue = value;\n          if (isArray(value)) {\n            if (value.length === 0) {\n              if (childNodes.length) {\n                childNodes = domdiff(\n                  node.parentNode,\n                  childNodes,\n                  [],\n                  diffOptions\n                );\n              }\n            } else {\n              switch (typeof value[0]) {\n                case 'string':\n                case 'number':\n                case 'boolean':\n                  anyContent(String(value));\n                  break;\n                case 'function':\n                  anyContent(value.map(invoke, node));\n                  break;\n                case 'object':\n                  if (isArray(value[0])) {\n                    value = value.concat.apply([], value);\n                  }\n                default:\n                  childNodes = domdiff(\n                    node.parentNode,\n                    childNodes,\n                    value,\n                    diffOptions\n                  );\n                  break;\n              }\n            }\n          } else if (canDiff(value)) {\n            childNodes = domdiff(\n              node.parentNode,\n              childNodes,\n              value.nodeType === 11 ?\n                slice.call(value.childNodes) :\n                [value],\n              diffOptions\n            );\n          } else if ('text' in value) {\n            anyContent(String(value.text));\n          } else if ('any' in value) {\n            anyContent(value.any);\n          } else if ('html' in value) {\n            childNodes = domdiff(\n              node.parentNode,\n              childNodes,\n              slice.call(\n                createContent(\n                  [].concat(value.html).join(''),\n                  nodeType\n                ).childNodes\n              ),\n              diffOptions\n            );\n          } else if ('length' in value) {\n            anyContent(slice.call(value));\n          }\n          break;\n      }\n    };\n    return anyContent;\n  },\n\n  // style or textareas don't accept HTML as content\n  // it's pointless to transform or analyze anything\n  // different from text there but it's worth checking\n  // for possible defined intents.\n  text(node) {\n    let oldValue;\n    const textContent = value => {\n      if (oldValue !== value) {\n        oldValue = value;\n        const type = typeof value;\n        if (type === 'object' && value) {\n          if ('text' in value) {\n            textContent(String(value.text));\n          } else if ('any' in value) {\n            textContent(value.any);\n          } else if ('html' in value) {\n            textContent([].concat(value.html).join(''));\n          } else if ('length' in value) {\n            textContent(slice.call(value).join(''));\n          }\n        } else if (type === 'function') {\n          textContent(value(node));\n        } else {\n          node.textContent = value == null ? '' : value;\n        }\n      }\n    };\n    return textContent;\n  }\n};\n\nfunction invoke(callback) {\n  return callback(this);\n}\n","import WeakMap from '@ungap/weakmap';\nimport tta from '@ungap/template-tag-arguments';\nimport {Wire, wireType, isArray} from './shared.js';\nimport Tagger from './tagger.js';\n\nconst wm = new WeakMap;\nconst container = new WeakMap;\n\nlet current = null;\n\n// can be used with any useRef hook\n// returns an `html` and `svg` function\nexport const hook = useRef => ({\n  html: createHook(useRef, html),\n  svg: createHook(useRef, svg)\n});\n\n// generic content render\nexport function render(node, callback) {\n  const value = update.call(this, node, callback);\n  if (container.get(node) !== value) {\n    container.set(node, value);\n    appendClean(node, value);\n  }\n  return node;\n}\n\n// keyed render via render(node, () => html`...`)\n// non keyed renders in the wild via html`...`\nexport const html = outer('html');\nexport const svg = outer('svg');\n\n// - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\nfunction appendClean(node, fragment) {\n  node.textContent = '';\n  node.appendChild(fragment);\n}\n\nfunction asNode(result, forceFragment) {\n  return result.nodeType === wireType ?\n    result.valueOf(forceFragment) :\n    result;\n}\n\nfunction createHook(useRef, view) {\n  return function () {\n    const ref = useRef(null);\n    if (ref.current === null)\n      ref.current = view.for(ref);\n    return asNode(ref.current.apply(null, arguments), false);\n  };\n}\n\nfunction outer(type) {\n  const wm = new WeakMap;\n  tag.for = (identity, id) => {\n    const ref = wm.get(identity) || set(identity);\n    if (id == null)\n      id = '$';\n    return ref[id] || create(ref, id);\n  };\n  return tag;\n  function create(ref, id) {\n    let wire = null;\n    const $ = new Tagger(type);\n    return (ref[id] = function () {\n      const result = $.apply(null, tta.apply(null, arguments));\n      return wire || (wire = wiredContent(result));\n    });\n  }\n  function set(identity) {\n    const ref = {'$': null};\n    wm.set(identity, ref);\n    return ref;\n  }\n  function tag() {\n    const args = tta.apply(null, arguments);\n    return current ?\n      new Hole(type, args) :\n      new Tagger(type).apply(null, args);\n  }\n}\n\nfunction set(node) {\n  const info = {\n    i: 0, length: 0,\n    stack: [],\n    update: false\n  };\n  wm.set(node, info);\n  return info;\n}\n\nfunction update(reference, callback) {\n  const prev = current;\n  current = wm.get(reference) || set(reference);\n  current.i = 0;\n  const ret = callback.call(this);\n  let value;\n  if (ret instanceof Hole) {\n    value = asNode(unroll(ret, 0), current.update);\n    const {i, length, stack, update} = current;\n    if (i < length)\n      stack.splice(current.length = i);\n    if (update)\n      current.update = false;\n  } else {\n    value = asNode(ret, false);\n  }\n  current = prev;\n  return value;\n}\n\nfunction unroll(hole, level) {\n  const {i, length, stack} = current;\n  const {type, args} = hole;\n  const stacked = i < length;\n  current.i++;\n  if (!stacked)\n    current.length = stack.push({\n      l: level,\n      kind: type,\n      tag: null,\n      tpl: args[0],\n      wire: null\n    });\n  unrollArray(args, 1, level + 1);\n  const info = stack[i];\n  if (stacked) {\n    const {l:control, kind, tag, tpl, wire} = info;\n    if (control === level && type === kind && tpl === args[0]) {\n      tag.apply(null, args);\n      return wire;\n    }\n  }\n  const tag = new Tagger(type);\n  const wire = wiredContent(tag.apply(null, args));\n  info.l = level;\n  info.kind = type;\n  info.tag = tag;\n  info.tpl = args[0];\n  info.wire = wire;\n  if (i < 1)\n    current.update = true;\n  return wire;\n}\n\nfunction unrollArray(arr, i, level) {\n  for (const {length} = arr; i < length; i++) {\n    const value = arr[i];\n    if (typeof value === 'object' && value) {\n      if (value instanceof Hole) {\n        arr[i] = unroll(value, level - 1);\n      } else if (isArray(value)) {\n        arr[i] = unrollArray(value, 0, level++);\n      }\n    }\n  }\n  return arr;\n}\n\nfunction wiredContent(node) {\n  const childNodes = node.childNodes;\n  const {length} = childNodes;\n  return length === 1 ?\n    childNodes[0] :\n    (length ? new Wire(childNodes) : node);\n}\n\nfunction Hole(type, args) {\n  this.type = type;\n  this.args = args;\n}\n","import wickedElements from 'wicked-elements'\nimport { html } from 'lighterhtml'\n\nfunction markerMenu (element) {\n  return html`<details class=\"MenuButton MenuButton--marker\">\n  <summary class=\"MenuButton-summary\" aria-label=\"Add marker to sidebar\"><svg viewBox=\"0 0 10 10\" fill=\"currentColor\" stroke=\"transparent\" width=\"15\" height=\"15\">\n  <path d=\"m1 4h8v2h-8zm3-3h2v8h-2z\"></path>\n</svg></summary>\n<marker-menu class=\"MenuButton-body MenuButton-body--right MarkerMenu\">\n  <dl>\n    <dt>Markers</dt>\n  <dd>\n    <ol>\n    <li>${button('✓', 'agree')}</li>\n    <li>${button('x', 'disagree')}</li>\n    <li>${button('~', 'interesting')}</li>\n    <li>${button('*', 'important')}</li>\n    </ol>\n  </dd>\n    <dt>Hands</dt>\n  <dd>\n    <ol>\n    <li>${button('👍', 'thumbs up')}</li>\n    <li>${button('👎', 'thumbs down')}</li>\n    <li>${button('✋', 'open hand')}</li>\n    <li>${button('👏', 'clapping')}</li>\n    </ol>\n  </dd>\n  <dt>Smileys</dt>\n  <dd>\n    <ol>\n    <li>${button('🙂', 'slightly smiling face')}</li>\n    <li>${button('🤨', 'face with raised eyebrows')}</li>\n    <li>${button('😍', 'smiling face with heart-shaped eyes')}</li>\n    <li>${button('😱', 'face screaming in fear')}</li>\n    <li>${button('😐', 'neutral face')}</li>\n    <li>${button('🙄', 'face with rolling eyes')}</li>\n    </ol>\n  </dd>\n</dl></div>\n  </details>`\n}\n\nconst descriptions = {\n  '✓': 'agree',\n  x: 'disagree',\n  '~': 'interesting',\n  '*': 'important',\n  '👍': 'thumbs up',\n  '👎': 'thumbs down',\n  '✋': 'open hand',\n  '👏': 'clapping',\n  '🙂': 'slightly smiling face',\n  '🤨': 'face with raised eyebrows',\n  '😍': 'smiling face with heart-shaped eyes',\n  '😱': 'face screaming in fear',\n  '😐': 'neutral face',\n  '🙄': 'face with rolling eyes'\n}\n\nfunction renderMarkers (element) {\n  return marker => {\n    const description = descriptions[marker]\n    const label = `Remove '${description}' sidebar marker`\n    return html`<button class=\"Button Button--marker\" aria-label=\"${label}\" is=\"marker-button\" data-description=\"${description}\">${marker}</button>`\n  }\n}\n\nfunction button (character, description) {\n  const label = `Add '${description}' sidebar marker`\n  return html`<button class=\"Button Button--marker\" aria-label=\"${label}\" is=\"add-marker-button\" data-description=\"${description}\">${character}</button>`\n}\n\nwickedElements.define('[is=\"add-marker-button\"]', {\n  onconnected (event) {\n    this.el = event.currentTarget\n    this.el.addEventListener('click', this)\n  },\n  onclick (event) {\n    const newMarker = marker(this.el)\n    const parent = this.el.closest('.Marker')\n    const reference = parent.querySelector('.MenuButton')\n    const description = this.el.dataset.description\n    const existing = parent.querySelector(\n      `[is=\"marker-button\"][data-description=\"${description}\"]`\n    )\n    if (existing) {\n      parent.removeChild(existing)\n    } else {\n      parent.insertBefore(newMarker, reference)\n    }\n  },\n  ondisconnected (event) {\n    this.el.removeEventListener('click', this)\n  }\n})\n\nfunction marker (element) {\n  const description = element.dataset.description\n  const character = element.textContent\n  const label = `Remove '${description}' sidebar marker`\n  return html`<button class=\"Button Button--marker\" aria-label=\"${label}\" is=\"marker-button\" data-description=\"${description}\">${character}</button>`\n}\n\nwickedElements.define('[is=\"marker-button\"]', {\n  onconnected (event) {\n    this.el = event.currentTarget\n    this.el.addEventListener('click', this)\n  },\n  onclick (event) {\n    const parent = this.el.parentElement\n    parent.removeChild(this.el)\n  },\n  ondisconnected (event) {\n    this.el.removeEventListener('click', this)\n  }\n})\n\nexport { markerMenu }\n","import wickedElements from 'wicked-elements'\nimport { html } from 'lighterhtml'\nimport { markerMenu } from './marker-menu.js'\n\nconst xpathObserver = new window.IntersectionObserver(onIntersection, {\n  rootMargin: '50px 0px'\n})\nconst positionObserver = new window.IntersectionObserver(onPosition, {\n  threshold: 1,\n  rootMargin: '0px 0px -50% 0px'\n})\nconst noteObserver = new window.IntersectionObserver(onNoteAppear, {\n  rootMargin: '50px 0px'\n})\n\nfunction onNoteAppear (entries) {\n  entries.forEach(entry => {\n    if (entry.intersectionRatio > 0) {\n      noteObserver.unobserve(entry.target)\n      const newNote = entry.target.cloneNode(true)\n      newNote.querySelector('.ql-container').innerHTML = newNote.querySelector(\n        '.ql-editor'\n      ).innerHTML\n      newNote.dataset.component = 'reader-note'\n      entry.target.parentElement.replaceChild(newNote, entry.target)\n    }\n  })\n}\n\nwickedElements.define('.ReaderNote--preRendered', {\n  init: function (event) {\n    noteObserver.observe(event.currentTarget)\n  },\n  onconnected (event) {\n    // // add position attributes to marker\n  },\n  ondisconnected (event) {\n    // remove drop down marker element from sidebar\n  }\n})\n\nlet highest\nfunction onPosition (entries) {\n  const nextHighest = entries.reduce((prev, current) => {\n    if (\n      current.intersectionRatio > prev.intersectionRatio &&\n      current.intersectionRatio === 1\n    ) {\n      return current\n    } else {\n      return prev\n    }\n  })\n  if (!highest) {\n    highest = nextHighest\n  } else if (nextHighest.intersectionRatio >= highest.intersectionRatio) {\n    highest = nextHighest\n  }\n  document.getElementById('chapter').dataset.currentPosition =\n    highest.target.dataset.xpath\n}\n\nfunction onIntersection (entries) {\n  entries.forEach(entry => {\n    if (entry.intersectionRatio > 0) {\n      xpathObserver.unobserve(entry.target)\n      addAnnotationTools(entry.target)\n    }\n  })\n}\n\nfunction addAnnotationTools (element) {\n  const xpath = element.dataset.xpath\n  // const formId = 'marker-' + xpath\n  // const checkId = 'marker-check-' + xpath\n  if (!element.querySelector('.NoteButton')) {\n    const button = html`<button class=\"Button Button--marker NoteButton\" data-component=\"note-button\" aria-label=\"Add note\" data-for=\"${xpath}\"><svg viewBox=\"0 0 10 10\" fill=\"currentColor\" stroke=\"transparent\" width=\"15\" height=\"15\">\n    <path d=\"m1 4h8v2h-8zm3-3h2v8h-2z\"></path>\n  </svg></button>`\n    element.appendChild(button)\n  }\n  const menuContainer = element.querySelector('.Marker')\n  if (menuContainer) {\n    const menu = markerMenu(element)\n    menuContainer.appendChild(menu)\n  }\n}\n\nwickedElements.define('[data-xpath]', {\n  init: function (event) {\n    xpathObserver.observe(event.currentTarget)\n    positionObserver.observe(event.currentTarget)\n  },\n  onconnected (event) {\n    // // add position attributes to marker\n  },\n  ondisconnected (event) {\n    // remove drop down marker element from sidebar\n  }\n})\n","import wickedElements from 'wicked-elements'\n\nwickedElements.define('[data-component=\"note-button\"]', {\n  init (event) {\n    this.element = event.currentTarget.closest('[data-xpath]')\n    event.currentTarget.addEventListener('click', this)\n    event.currentTarget.dataset.reader = true\n  },\n  onclick (event) {\n    const { element } = this\n    const noteElement = document.getElementById(makeNoteId(element))\n    if (noteElement) {\n      noteElement.querySelector('.ql-editor').focus()\n    } else {\n      const newNote = note(element)\n      element.parentElement.insertBefore(newNote, element.nextSibling)\n      window.requestAnimationFrame(function () {\n        newNote.querySelector('.ql-editor').focus()\n      })\n    }\n  }\n})\n\nwickedElements.define('[data-component=\"reader-note\"]', {\n  init (event) {\n    const element = (this.el = event.currentTarget)\n    const container = this.el.querySelector('.ReaderNote-textarea')\n    this.quill = new window.Quill(container, {\n      modules: {\n        toolbar: [\n          ['bold', 'italic', 'underline'],\n          ['image', 'code-block'],\n          ['link', 'blockquote'],\n          [{ list: 'ordered' }, { list: 'bullet' }],\n          ['clean']\n        ]\n      },\n      theme: 'snow'\n    })\n    this.toolbar = this.el.querySelector('.ql-toolbar')\n    const onFocus = this.onfocus\n    const onBlur = this.onblur\n    this.el.classList.remove('ReaderNote--preRendered')\n    this.quill.on('selection-change', function (range, oldRange, source) {\n      if (range) {\n        onFocus(element)\n      } else {\n        onBlur(element)\n      }\n    })\n    this.quill.on('text-change', function () {\n      element.classList.add('ReaderNote--hasContent')\n    })\n    const button = document.createElement('button')\n    button.textContent = 'Delete'\n    button.classList.add('TextButton')\n    button.classList.add('TextButton--noteDelete')\n    button.addEventListener('click', event => {\n      this.el.parentElement.removeChild(this.el)\n    })\n    button.dataset.noteDelete = 'true'\n    this.el.appendChild(button)\n  },\n  onfocus (element) {\n    element.classList.add('ReaderNote--hasFocus')\n  },\n  onblur (element) {\n    element.classList.remove('ReaderNote--hasFocus')\n  }\n})\n\nfunction note (element) {\n  const xpath = element.dataset.xpath\n  const form = document.createElement('form')\n  form.dataset.component = 'reader-note'\n  form.dataset.for = xpath\n  form.dataset.reader = 'true'\n  form.classList.add('ReaderNote')\n  form.id = 'ReaderNote-' + xpath\n  const textareaId = 'ReaderNote-text-' + xpath\n  form.dataset.newNote = 'true'\n  form.innerHTML = `<div class=\"ReaderNote-textarea\" id=\"${textareaId}\" data-reader=\"true\" aria-label=\"Sidebar note\"></div>`\n  const button = document.createElement('button')\n  button.textContent = 'Cancel'\n  button.classList.add('TextButton')\n  button.classList.add('TextButton--noteButton')\n  button.addEventListener('click', event => {\n    form.parentElement.removeChild(form)\n  })\n  button.dataset.noteCancel = 'true'\n  form.appendChild(button)\n  return form\n}\n\nfunction makeNoteId (element) {\n  return 'ReaderNote-' + element.dataset.xpath\n}\n"],"names":["$Event","Event","o_O","CustomEvent","type","e","document","createEvent","initEvent","$WeakSet","WeakSet","constructor","WeakMap","this","$","prototype","add","O","set","has","delete","i","Math","random","join","Object","defineProperty","value","configurable","hasOwnProperty","call","assign","target","o","arguments","length","k","contains","el","parentNode","indexOf","matches","documentElement","selector","matchesSelector","webkitMatchesSelector","khtmlMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","querySelectorAll","bootstrap","query","config","waiting","known","regularElements","define","options","doc","MutationObserver","changes","observe","subtree","childList","addEventListener","addedNodes","readyState","ready","once","init","Error","push","nodeType","setupListeners","get","whenDefined","Promise","resolve","lifecycle","poly","CONNECTED","DISCONNECTED","notObserving","observer","node","dispatched","timer","records","reschedule","record","clearTimeout","setTimeout","splice","event","removedNodes","Tracker","dispatchAll","nodes","counter","dispatchTarget","dispatchEvent","children","startObserving","ownerDocument","disconnected","attributechanged","attributeFilter","attributes","attributeOldValue","filtered","Array","slice","handleEvent","attrModified","attrName","prevValue","attributeName","oldValue","newValue","getAttribute","connected","setupList","setup","ws","css","isElement","setupListener","dispatch","method","create","wickedElements","component","definition","onconnected","currentTarget","removeEventListener","handler","invoke","key","addIfNeeded","filter","out","noop","tagName","n","arr","ele","start","len","exports","iter","where","whatToShow","SHOW_TEXT","E_SHOW","count","referenceNode","predicates","isNaN","parseInt","isFinite","forward","backward","TEXT_NODE","isText","E_WHERE","ref","common","left","concat","_ancestors2","reverse","right","shift","l","_indexOf2","childNodes","r","before","pointerBeforeReferenceNode","nextNode","nodeValue","previousNode","_interopRequireDefault","_ancestors","_indexOf","obj","__esModule","default","require$$0","rangeId","highlightString","text","offset","body","textContent","iterator","createNodeIterator","window","NodeFilter","split","seek","splitText","end","nodeCollector","parentElement","closest","highlight","createElement","dataset","reader","classList","replaceChild","appendChild","[object Object]","element","selected","forEach","detail","remove","disabled","range","createRange","setStartBefore","firstChild","setEndAfter","lastChild","fragment","extractContents","onreader:highlight-selected","console","log","onreader:highlight-deselected","selection","getSelection","isCollapsed","rangeCount","endRange","getRangeAt","setEnd","endContainer","endOffset","texts","startContainer","getElementById","SHOW_ALL","ranges","newRange","setStart","startOffset","setEndBefore","undefined","map","toString","getTexts","rangeString","collapseToStart","parent","container","querySelector","quill","Quill","modules","toolbar","list","theme","onFocus","onfocus","onBlur","onblur","on","oldRange","source","button","removeChild","noteDelete","name","running","requestAnimationFrame","throttle","setSize","size","offsetWidth","style","setProperty","self","id","dP","hOP","proto","_","iterable","pair","templateLiteral","isNoOp","tl","propertyIsEnumerable","isFrozen","test","defaultView","navigator","userAgent","parseFloat","RegExp","$1","forever","TL","template","args","unique","Wire","ELEMENT_NODE","keepFirst","first","last","deleteContents","valueOf","forceAppend","noFragment","createDocumentFragment","isArray","wireType","createContent","FRAGMENT","createHTML","html","innerHTML","content","append","markup","svg","root","createElementNS","Map","v","had","insertBefore","eqeq","a","b","identity","moreNodes","moreStart","moreEnd","lessNodes","lessStart","lessEnd","compare","m","next","nextSibling","findK","ktr","j","lo","hi","mid","smartDiff","futureNodes","futureStart","futureEnd","futureChanges","currentNodes","currentStart","currentEnd","currentChanges","currentLength","diff","live","currentIndex","applyDiff","rows","cols","d","c","pv","cv","pd","outer","diffIdx","OND","minLen","link","tresh","keymap","idxInOld","newi","oldi","prev","ptr","HS","domdiff","currentSame","futureSame","isReversed","importNode","cloneNode","createTextNode","native","deep","clone","trim","String","replace","UID","toFixed","UIDC","COMMENT_NODE","SHOULD_USE_TEXT_CONTENT","VOID_ELEMENTS","spaces","attrPartials","attrSeeker","selfClosing","findAttributes","attrReplacer","$0","$2","$3","replaceAttributes","fullClosing","path","find","parseAttributes","holes","parts","cache","array","attribute","realName","toLowerCase","attr","removeAttribute","removeAttributeNode","nodeName","script","setAttributeNode","parsed","referenced","createInfo","sanitize","transform","child","cleanContent","parse","childPath","info","updates","callbacks","any","values","domtagger","details","createDetails","apply","hyperStyle","IS_NON_DIMENSIONAL","hyphen","original","setAttribute","getAttributeNode","update","ized","isSVG","oldType","styleValue","cssText","object","toStyle","asNode","item","hyperProperty","readOnly","Tagger","callback","current","hyperRef","hyperEvent","owner","hyperAttribute","diffOptions","fastPath","anyContent","canDiff","wm","tag","for","wire","result","tta","wiredContent","Hole","character","description","newMarker","marker","reference","existing","xpathObserver","IntersectionObserver","entries","entry","intersectionRatio","unobserve","xpath","menuContainer","menu","addAnnotationTools","rootMargin","positionObserver","nextHighest","reduce","highest","currentPosition","threshold","noteObserver","newNote","noteElement","makeNoteId","focus","form","textareaId","noteCancel","note"],"mappings":"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"}